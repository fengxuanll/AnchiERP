!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.avalon=t():e.avalon=t()}(this,function(){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var a=n(1);n(8),n(15),n(19),n(35),n(71),a.onComponentDispose=n(75),n(76),e.exports=a},function(e,t,n){n(2);var a=n(3),r=n(4);a.shadowCopy(a,r),n(5),n(6),n(7),e.exports=a},function(e,t){function n(e,t,n){var a="for(var "+e+"i=0,n = this.length; i < n; i++){"+t.replace("_","((i in this) && fn.call(scope,this[i],i,this))")+"}"+n;return Function("fn,scope",a)}var a=Object.prototype.hasOwnProperty;if(!"司徒正美".trim){var r=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(r,"")}}var o=!{toString:null}.propertyIsEnumerable("toString"),i=function(){}.propertyIsEnumerable("prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],s=l.length;Object.keys||(Object.keys=function(e){var t=[],n=i&&"function"==typeof e;if("string"==typeof e||e&&e.callee)for(var r=0;r<e.length;++r)t.push(String(r));else for(var c in e)n&&"prototype"===c||!a.call(e,c)||t.push(String(c));if(o)for(var u=e.constructor,v=u&&u.prototype===e,f=0;s>f;f++){var d=l[f];v&&"constructor"===d||!a.call(e,d)||t.push(d)}return t}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),Array.isArray.bind||(Function.prototype.bind=function(e){if(arguments.length<2&&void 0===e)return this;var t=this,n=arguments;return function(){var a,r=[];for(a=1;a<n.length;a++)r.push(n[a]);for(a=0;a<arguments.length;a++)r.push(arguments[a]);return t.apply(e,r)}});var c=Array.prototype.slice;try{c.call(document.documentElement)}catch(u){Array.prototype.slice=function(e,t){if(t="undefined"!=typeof t?t:this.length,Array.isArray(this))return c.call(this,e,t);var n,a,r=[],o=this.length,i=e||0;i=i>=0?i:o+i;var l=t?t:o;if(0>t&&(l=o+t),a=l-i,a>0)if(r=new Array(a),this.charAt)for(n=0;a>n;n++)r[n]=this.charAt(i+n);else for(n=0;a>n;n++)r[n]=this[i+n];return r}}var v=Array.prototype;if(!/\[native code\]/.test(v.map)){var f={indexOf:function(e,t){var n=this.length,a=~~t;for(0>a&&(a+=n);n>a;a++)if(this[a]===e)return a;return-1},lastIndexOf:function(e,t){var n=this.length,a=null==t?n-1:t;for(0>a&&(a=Math.max(0,n+a));a>=0;a--)if(this[a]===e)return a;return-1},forEach:n("","_",""),filter:n("r=[],j=0,","if(_)r[j++]=this[i]","return r"),map:n("r=[],","r[i]=_","return r"),some:n("","if(_)return true","return false"),every:n("","if(!_)return false","return true")};for(var d in f)v[d]=f[d]}e.exports={}},function(e,t){(function(t){function n(e){return new n.init(e)}t.avalon=n,"undefined"!=typeof window&&(window.avalon=n),n.init=function(e){this[0]=this.element=e},n.fn=n.prototype=n.init.prototype,n.shadowCopy=function(e,t){for(var n in t)e[n]=t[n];return e};var a=/[^, ]+/g,r=t.console;n.shadowCopy(n,{noop:function(){},rword:a,inspect:{}.toString,ohasOwn:{}.hasOwnProperty,log:function(){r&&n.config.debug&&Function.apply.call(console.log,console,arguments)},warn:function(){if(r&&n.config.debug){var e=console.warn||console.log;Function.apply.call(e,console,arguments)}},error:function(e,t){throw(t||Error)(e)},oneObject:function(e,t){"string"==typeof e&&(e=e.match(a)||[]);for(var n={},r=void 0!==t?t:1,o=0,i=e.length;i>o;o++)n[e[o]]=r;return n}}),e.exports=n}).call(t,function(){return this}())},function(e,t){(function(t){var n=t,a={window:n,document:{createElement:function(){return{}},createElementNS:function(){return{}},contains:Boolean},root:{outerHTML:"x"},msie:NaN,modern:!0,avalonDiv:{},avalonFragment:null};if(n.location&&n.navigator&&n.window){var r=n.document;a.document=r,a.modern=n.dispatchEvent,a.root=r.documentElement,a.avalonDiv=r.createElement("div"),a.avalonFragment=r.createDocumentFragment(),n.VBArray&&(a.msie=r.documentMode||(n.XMLHttpRequest?7:6))}e.exports=a}).call(t,function(){return this}())},function(e,t){function n(e){return h.lastIndex=0,'"'+(h.test(e)?String(e).replace(h,p):e)+'"'}function a(e){return i.test(o.call(e))}function r(e){if(!e)return!1;var t=e.length;if(t===t>>>0){var n=o.call(e).slice(8,-1);if(s.test(n))return!1;if("Array"===n)return!0;try{return{}.propertyIsEnumerable.call(e,"length")===!1?y.test(e.item||e.callee):!0}catch(a){return!e.window}}return!1}var o=avalon.inspect,i=/^\[object (?:Window|DOMWindow|global)\]$/,l=/\[native code\]/,s=/(Array|List|Collection|Map|Arguments)\]$/,c=avalon.ohasOwn,u={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},v="000000",f=function(e,t){return(v+(t||0)).slice(-e)},d="\\u00",p=function(e){var t=e.charCodeAt(0),n=u[t];return n?n:d+f(2,t.toString(16))},h=/[\x00-\x1f\x22\x5c]/g;avalon.quote="undefined"!=typeof JSON?JSON.stringify:n;var m={};"Boolean Number String Function Array Date RegExp Object Error".replace(avalon.rword,function(e){m["[object "+e+"]"]=e.toLowerCase()}),avalon.type=function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?m[o.call(e)]||"object":typeof e};var y=/^\s*\bfunction\b/;avalon.isFunction="object"==typeof alert?function(e){try{return y.test(e+"")}catch(t){return!1}}:function(e){return"[object Function]"===o.call(e)},avalon.isWindow=function(e){return e?e==e.document&&e.document!=e:!1},a(avalon.window)&&(avalon.isWindow=a);var g,_;for(g in avalon({}))break;_="0"!==g,avalon.isPlainObject=function(e,t){if(!e||"object"!==avalon.type(e)||e.nodeType||avalon.isWindow(e))return!1;try{if(e.constructor&&!c.call(e,"constructor")&&!c.call(e.constructor.prototype||{},"isPrototypeOf"))return!1}catch(n){return!1}if(_)for(t in e)return c.call(e,t);for(t in e);return void 0===t||c.call(e,t)},l.test(Object.getPrototypeOf)&&(avalon.isPlainObject=function(e){return"[object Object]"===o.call(e)&&Object.getPrototypeOf(e)===Object.prototype}),avalon.mix=avalon.fn.mix=function(){var e,t,n,a,r,o,i=arguments[0]||{},l=1,s=arguments.length,c=!1;for("boolean"==typeof i&&(c=i,i=arguments[1]||{},l++),"object"==typeof i||avalon.isFunction(i)||(i={}),l===s&&(i=this,l--);s>l;l++)if(null!=(e=arguments[l]))for(t in e){try{n=i[t],a=e[t]}catch(u){continue}i!==a&&(c&&a&&(avalon.isPlainObject(a)||(r=Array.isArray(a)))?(r?(r=!1,o=n&&Array.isArray(n)?n:[]):o=n&&avalon.isPlainObject(n)?n:{},i[t]=avalon.mix(c,o,a)):void 0!==a&&(i[t]=a))}return i},avalon.each=function(e,t){if(e){var n=0;if(r(e))for(var a=e.length;a>n&&t(n,e[n])!==!1;n++);else for(n in e)if(e.hasOwnProperty(n)&&t(n,e[n])===!1)break}},e.exports={avalon:avalon,isArrayLike:r}},function(e,t){function n(e,t,n){e[n.name]=avalon.parseExpr(n)}var a={},r=/([a-z\d])([A-Z]+)/g,o=/[-_][^-_]/g,i=/\d\.\d{4}/,l=/[-.*+?^${}()|[\]\/\\]/g,s=[].slice;avalon.shadowCopy(avalon,{caches:{},vmodels:{},filters:{},components:{},directives:{},eventHooks:{},eventListeners:{},validators:{},scopes:{},cssHooks:a,parsers:{number:function(e){return""===e?"":/\d\.$/.test(e)?e:parseFloat(e)||0},string:function(e){return null===e||void 0===e?"":e+""},"boolean":function(e){return""===e?e:"true"===e||"1"==e}},version:"2.10",slice:function(e,t,n){return s.call(e,t,n)},css:function(e,t,n,r){if(e instanceof avalon&&(e=e[0]),1===e.nodeType){var o=avalon.camelize(t);if(t=avalon.cssName(o)||o,void 0===n||"boolean"==typeof n){r=a[o+":get"]||a["@:get"],"background"===t&&(t="backgroundColor");var i=r(e,t);return n===!0?parseFloat(i)||0:i}if(""===n)e.style[t]="";else{if(null==n||n!==n)return;isFinite(n)&&!avalon.cssNumber[o]&&(n+="px"),r=a[o+":set"]||a["@:set"],r(e,t,n)}}},directive:function(e,t){return t.parse=t.parse||n,this.directives[e]=t},isObject:function(e){return null!==e&&"object"==typeof e},range:function(e,t,n){n||(n=1),null==t&&(t=e||0,e=0);for(var a=-1,r=Math.max(0,Math.ceil((t-e)/n)),o=new Array(r);++a<r;)o[a]=e,e+=n;return o},hyphen:function(e){return e.replace(r,"$1-$2").toLowerCase()},camelize:function(e){return!e||e.indexOf("-")<0&&e.indexOf("_")<0?e:e.replace(o,function(e){return e.charAt(1).toUpperCase()})},makeHashCode:function(e){return e=e||"avalon",String(Math.random()+Math.random()).replace(i,e)},escapeRegExp:function(e){return(e+"").replace(l,"\\$&")},Array:{merge:function(e,t){e.push.apply(e,t)},ensure:function(e,t){return-1===e.indexOf(t)?e.push(t):void 0},removeAt:function(e,t){return!!e.splice(t,1).length},remove:function(e,t){var n=e.indexOf(t);return~n?avalon.Array.removeAt(e,n):!1}}}),"undefined"!=typeof performance&&performance.now&&(avalon.makeHashCode=function(e){return e=e||"avalon",(e+performance.now()).replace(".","")});var c=1;e.exports={avalon:avalon,getLongID:function(e){return e.uuid||(e.uuid=avalon.makeHashCode("e"))},getShortID:function(e){return e.uuid||(e.uuid="_"+ ++c)}}},function(e,t){function n(e){for(var t in e)if(avalon.ohasOwn.call(e,t)){var a=e[t];"function"==typeof n.plugins[t]?n.plugins[t](a):"object"==typeof n[t]?avalon.shadowCopy(n[t],a):n[t]=a}return this}avalon.config=n;var a={interpolate:function(e){var t=e[0],a=e[1];if(t===a)throw new SyntaxError("openTag!==closeTag");var r=t+"test"+a,o=avalon.avalonDiv;if(o.innerHTML=r,o.innerHTML!==r&&o.innerHTML.indexOf("&lt;")>-1)throw new SyntaxError("此定界符不合法");o.innerHTML="",n.openTag=t,n.closeTag=a;var i=avalon.escapeRegExp(t),l=avalon.escapeRegExp(a);n.rexpr=new RegExp(i+"([\\s\\S]*)"+l),n.rexprg=new RegExp(i+"([\\s\\S]*)"+l,"g"),n.rbind=new RegExp(i+"[\\s\\S]*"+l+"|\\bms-|\\bslot\\b")}};n.plugins=a,avalon.config({interpolate:["{{","}}"],debug:!0})},function(e,t,n){function a(e){return e}var r=n(9),o=n(10),i=n(11),l=n(12),s=n(13),c=n(14),u=avalon.filters;avalon.__format__=function(e){var t=u[e];return t?t.get?t.get:t:a},avalon.mix(u,{uppercase:function(e){return String(e).toUpperCase()},lowercase:function(e){return String(e).toLowerCase()},truncate:function(e,t,n){return t=t||30,n="string"==typeof n?n:"...",e.length>t?e.slice(0,t-n.length)+n:String(e)},camelize:avalon.camelize,date:l,escape:o,sanitize:i,number:r,currency:function(e,t,n){return(t||"￥")+r(e,isFinite(n)?n:2)}},s,c),e.exports=avalon},function(e,t){function n(e,t,n,a){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var r=isFinite(+e)?+e:0,o=isFinite(+t)?Math.abs(t):3,i=a||",",l=n||".",s="",c=function(e,t){var n=Math.pow(10,t);return""+(Math.round(e*n)/n).toFixed(t)};return s=(o?c(r,o):""+Math.round(r)).split("."),s[0].length>3&&(s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(s[1]||"").length<o&&(s[1]=s[1]||"",s[1]+=new Array(o-s[1].length+1).join("0")),s.join(l)}e.exports=n},function(e,t){function n(e){return String(e).replace(/&/g,"&amp;").replace(a,function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return"&#"+(1024*(t-55296)+(n-56320)+65536)+";"}).replace(r,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var a=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,r=/([^\#-~| |!])/g;e.exports=n},function(e,t){var n=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,a=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,r=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,o={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi};e.exports=function(e){return e.replace(n,"").replace(r,function(e,t){var n=e.toLowerCase().match(/<(\w+)\s/);if(n){var r=o[n[1]];r&&(e=e.replace(r,function(e,t,n){var a=n.charAt(0);return t+"="+a+"javascript:void(0)"+a}))}return e.replace(a," ").replace(/\s+/g," ")})}},function(e,t){function n(e){return parseInt(e,10)||0}function a(e,t,n){var a="";for(0>e&&(a="-",e=-e),e=""+e;e.length<t;)e="0"+e;return n&&(e=e.substr(e.length-t)),a+e}function r(e,t,n,r){return function(o){var i=o["get"+e]();return(n>0||i>-n)&&(i+=n),0===i&&-12===n&&(i=12),a(i,t,r)}}function o(e,t){return function(n,a){var r=n["get"+e](),o=(t?"SHORT"+e:e).toUpperCase();return a[o][r]}}function i(e){var t=-1*e.getTimezoneOffset(),n=t>=0?"+":"";return n+=a(Math[t>0?"floor":"ceil"](t/60),2)+a(Math.abs(t%60),2)}function l(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]}function s(e,t){var a,r,o=s.locate,i="",l=[];if(t=t||"mediumDate",t=o[t]||t,"string"==typeof e)if(/^\d+$/.test(e))e=n(e);else if(v.test(e))e=+RegExp.$1;else{var f=e.trim(),d=[0,0,0,0,0,0,0],p=new Date(0);f=f.replace(/^(\d+)\D(\d+)\D(\d+)/,function(e,t,a,r){var o=4===r.length?[r,t,a]:[t,a,r];return d[0]=n(o[0]),d[1]=n(o[1])-1,d[2]=n(o[2]),""});var h=p.setFullYear,m=p.setHours;f=f.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(e,t,a,r,o){return d[3]=n(t),d[4]=n(a),d[5]=n(r),o&&(d[6]=Math.round(1e3*parseFloat("0."+o))),""});var y=0,g=0;f=f.replace(/Z|([+-])(\d\d):?(\d\d)/,function(e,t,a,r){return h=p.setUTCFullYear,m=p.setUTCHours,t&&(y=n(t+a),g=n(t+r)),""}),d[3]-=y,d[4]-=g,h.apply(p,d.slice(0,3)),m.apply(p,d.slice(3)),e=p}if("number"==typeof e&&(e=new Date(e)),"date"===avalon.type(e)){for(;t;)r=u.exec(t),r?(l=l.concat(r.slice(1)),t=l.pop()):(l.push(t),t=null);return l.forEach(function(t){a=c[t],i+=a?a(e,o):t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),i}}var c={yyyy:r("FullYear",4),yy:r("FullYear",2,0,!0),y:r("FullYear",1),MMMM:o("Month"),MMM:o("Month",!0),MM:r("Month",2,1),M:r("Month",1,1),dd:r("Date",2),d:r("Date",1),HH:r("Hours",2),H:r("Hours",1),hh:r("Hours",2,-12),h:r("Hours",1,-12),mm:r("Minutes",2),m:r("Minutes",1),ss:r("Seconds",2),s:r("Seconds",1),sss:r("Milliseconds",3),EEEE:o("Day"),EEE:o("Day",!0),a:l,Z:i},u=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,v=/^\/Date\((\d+)\)\/$/,f={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};f.SHORTMONTH=f.MONTH,s.locate=f,e.exports=s},function(e,t){function n(e,t,n){var a=avalon.type(e);if("array"!==a&&"object"!==a)throw"orderBy只能处理对象或数组";var r=n&&0>n?-1:1;if("string"==typeof t){var o=t;t=function(e){return e&&e[o]}}e=l(e),e.forEach(function(e){e.order=t(e.value,e.key)}),e.sort(function(e,t){var n=e.order,a=t.order;return Number.isNaN(n)&&Number.isNaN(a)?0:n===a?0:n>a?r:-r});var s="array"===a,c=s?[]:{};return i(c,e,function(e){s?c.push(e.value):c[e.key]=e.value})}function a(e,t){var n=avalon.type(e);if("array"!==n&&"object"!==n)throw"filterBy只能处理对象或数组";var a=avalon.slice(arguments,2),r=avalon.type(t);if("function"===r)var o=t;else{if("string"!==r&&"number"!==r)return e;if(""===t)return e;var s=new RegExp(avalon.escapeRegExp(t),"i");o=function(e){return s.test(e)}}e=l(e).filter(function(e,t){return!!o.apply(e,[e.value,t].concat(a))});var c="array"===n,u=c?[]:{};return i(u,e,function(e){c?u.push(e.value):u[e.key]=e.value})}function r(e,t,n){if(avalon.isObject(e)&&!Array.isArray(e)){var a=[];return i(a,t,function(t){a.push(e.hasOwnProperty(t)?e[t]:n?n[t]:"")})}return e}function o(e,t,n){var a=avalon.type(e);if("array"!==a&&"object"!==a)throw"limitBy只能处理对象或数组";if(t=Math.abs(Number(t))===1/0?Number(t):parseInt(t,10),Number.isNaN(t))return e;"object"===a&&(e=l(e)),t=Math.min(e.length,t),n=!n||Number.isNaN(n)?0:~~n,0>n&&(n=Math.max(0,e.length+n));for(var r=[],o=n;t>o;o++)r.push(e[o]);var s="array"===a;if(s)return r;var c={};return i(c,r,function(e){c[e.key]=e.value})}function i(e,t,n){for(var a=0,r=t.length;r>a;a++)n(t[a]);return e}function l(e){var t=[],n=0;return avalon.each(e,function(e,a){t[n++]={value:a,key:e}}),t}Number.isNaN=Number.isNaN||function(e){return e!==e},e.exports={limitBy:o,orderBy:n,selectBy:r,filterBy:a}},function(e,t){var n={stop:function(e){return e.stopPropagation(),e},prevent:function(e){return e.preventDefault(),e}},a={esc:27,tab:9,enter:13,space:32,del:46,up:38,left:37,right:39,down:40};avalon.each(a,function(e,t){n[e]=function(e){return e.which!==t&&(e.$return=!0),e}}),e.exports=n},function(e,t,n){var a=n(16),r=n(17),o=n(18);avalon.vdomAdaptor=function(e,t){if(!e)return"toHTML"===t?"":avalon.avalonFragment.cloneNode(!1);switch(e.nodeType){case 3:return a.prototype[t].call(e);case 8:return r.prototype[t].call(e);case 1:return o.prototype[t].call(e);default:if(Array.isArray(e)){if("toHTML"===t)return e.map(function(e){return avalon.vdomAdaptor(e,"toHTML")}).join("");var n=avalon.avalonFragment.cloneNode(!1);return e.forEach(function(e){n.appendChild(avalon.vdomAdaptor(e,"toDOM"))}),n}}},e.exports={VText:a,VComment:r,VElement:o}},function(e,t){function n(e){if("string"==typeof e)this.type="#text",this.nodeValue=e,this.skipContent=!a.test(e),this.nodeType=3;else for(var t in e)this[t]=e[t]}var a=avalon.config.rexpr;n.prototype={constructor:n,toDOM:function(){var e=n.decoder=n.decoder||document.createElement("p");return e.innerHTML=this.nodeValue,e.removeChild(e.firstChild)},toHTML:function(){return this.nodeValue}},e.exports=n},function(e,t){function n(e){if("string"==typeof e)this.type="#comment",this.nodeValue=e,this.skipContent=!0,this.nodeType=8;else for(var t in e)this[t]=e[t]}n.prototype={constructor:n,toDOM:function(){return document.createComment(this.nodeValue)},toHTML:function(){return"<!--"+this.nodeValue+"-->"}},e.exports=n},function(e,t){function n(e,t,n){if("object"==typeof e)for(var a in e)this[a]=e[a];else this.nodeType=1,this.type=e,this.props=t,this.children=n}function a(e){return e!==!1&&Object(e)!==e}function r(e){document.styleSheets.length<31?document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"):document.styleSheets[0].addRule(".rvml","behavior:url(#default#VML)");var t=e.split(":");1===t.length&&t.unshift("v");var n=t[1],a=t[0];return document.namespaces[a]||document.namespaces.add(a,"urn:schemas-microsoft-com:vml"),document.createElement("<"+a+":"+n+' class="rvml">')}function o(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}var i={"class":function(e,t){e.className=t},style:function(e,t){e.style.cssText=t},"for":function(e,t){e.htmlFor=t}},l=avalon.oneObject("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use,g,svg"),s=avalon.oneObject("shape,line,polyline,rect,roundrect,oval,arc,curve,background,image,shapetype,group,fill,stroke,shadow, extrusion, textbox, imagedata, textpath"),c=/^\w+\:\w+/;n.prototype={constructor:n,toDOM:function(){var e,t=this.type;e=avalon.modern&&l[t]?o(t):avalon.modern||!s[t]&&!c.test(t)?document.createElement(t):r(t);var n=this.props["ms-important"]||this.props["ms-controller"]||this.wid;if(n){var u=avalon.scopes[n],v=u&&u.vmodel&&u.vmodel.$element;if(v){var f=v.vtree[0];return f.children&&(this.children=f.children),v}}for(var d in this.props){var p=this.props[d];a(p)&&(i[d]&&avalon.msie<8?i[d](e,p):e.setAttribute(d,p+""))}var h=this.children||[],m=h[0]?h[0].nodeValue:"";switch(this.type){case"script":e.text=m;break;case"style":"styleSheet"in e?(e.setAttribute("type","text/css"),e.styleSheet.cssText=m):e.innerHTML=m;break;case"template":e.innerHTML=m;break;case"noscript":e.textContent=m;break;default:this.isVoidTag||this.children.forEach(function(t){t&&e.appendChild(avalon.vdomAdaptor(t,"toDOM"))})}return e},toHTML:function(){var e=[];for(var t in this.props){var n=this.props[t];a(n)&&e.push(t+"="+avalon.quote(this.props[t]+""))}e=e.length?" "+e.join(" "):"";var r="<"+this.type+e;return this.isVoidTag?r+"/>":(r+=">",this.children.length&&(r+=this.children.map(function(e){return e?avalon.vdomAdaptor(e,"toHTML"):""}).join("")),r+"</"+this.type+">")}},e.exports=n},function(e,t,n){n(20),n(21),n(22),n(25),n(26),n(27),n(30),n(32),e.exports=avalon},function(e,t){function n(e,t){try{for(;t=t.parentNode;)if(t===e)return!0;return!1}catch(n){return!1}}avalon.contains=n,avalon.document.contains||(avalon.document.contains=function(e){return n(document,e)}),window.Node&&!document.createTextNode("x").contains&&(Node.prototype.contains=function(e){return!!(16&this.compareDocumentPosition(e))}),window.HTMLElement&&!avalon.root.outerHTML&&HTMLElement.prototype.__defineGetter__("outerHTML",function(){var e=document.createElement("div");return e.appendChild(this),e.innerHTML})},function(e,t){function n(e){if(!("classList"in e)){e.classList={node:e};for(var t in r)e.classList[t.slice(1)]=r[t]}return e.classList}var a=/\S+/g,r={_toString:function(){var e=this.node,t=e.className,n="string"==typeof t?t:t.baseVal,r=n.match(a);return r?r.join(" "):""},_contains:function(e){return(" "+this+" ").indexOf(" "+e+" ")>-1},_add:function(e){this.contains(e)||this._set(this+" "+e)},_remove:function(e){this._set((" "+this+" ").replace(" "+e+" "," "))},__set:function(e){e=e.trim();var t=this.node;"object"==typeof t.className?t.setAttribute("class",e):t.className=e}};"add,remove".replace(avalon.rword,function(e){avalon.fn[e+"Class"]=function(t){var r=this[0]||{};return t&&"string"==typeof t&&1===r.nodeType&&t.replace(a,function(t){n(r)[e](t)}),this}}),avalon.fn.mix({hasClass:function(e){var t=this[0]||{};return 1===t.nodeType&&n(t).contains(e)},toggleClass:function(e,t){var n="boolean"==typeof t,r=this;return String(e).replace(a,function(e){var a=n?t:!r.hasClass(e);r[a?"addClass":"removeClass"](e)}),this}})},function(e,t,n){function a(e,t){var n=t.changeAttr;if(e&&1===e.nodeType&&n){for(var a in n){var s=n[a];if("href"===a||"src"===a){if(e.hasAttribute||(s=String(s).replace(l,"&")),e[a]=s,window.chrome&&"EMBED"===e.tagName){var c=e.parentNode,u=document.createComment("ms-src");c.replaceChild(u,e),c.replaceChild(e,u)}}else if(0===a.indexOf("data-"))e.setAttribute(a,s);else{var v=r[a]||a;if("boolean"==typeof e[v]&&(e[v]=!!s),s===!1){e.removeAttribute(v);continue}var f=i.test(e)?!1:!avalon.modern&&o(e)?!0:a in e.cloneNode(!1);f?e[v]=s+"":e.setAttribute(a,s)}}t.changeAttr=null}}var r=n(23),o=n(24),i=/^\[object SVG\w*Element\]$/,l=/&amp;/g,s=/^[\],:{}\s]*$/,c=/(?:^|:|,)(?:\s*\[)+/g,u=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,v=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g;avalon.parseJSON=avalon.window.JSON?JSON.parse:function(e){if("string"==typeof e){if(e=e.trim(),e&&s.test(e.replace(u,"@").replace(v,"]").replace(c,"")))return new Function("return "+e)();avalon.error("Invalid JSON: "+e)}return e},avalon.fn.attr=function(e,t){return 2===arguments.length?(this[0].setAttribute(e,t),this):this[0].getAttribute(e)},e.exports=a},function(e,t){var n={"accept-charset":"acceptCharset","char":"ch",charoff:"chOff","class":"className","for":"htmlFor","http-equiv":"httpEquiv"},a=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected,","isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(",");a.replace(/\w+/g,function(e){n[e.toLowerCase()]=e});var r=["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,contentEditable,frameBorder,longDesc,maxLength,marginWidth,marginHeight,rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(",");r.replace(/\w+/g,function(e){n[e.toLowerCase()]=e}),e.exports=n},function(e,t){function n(e){var t=e.nodeName;return t.toLowerCase()===t&&e.scopeName&&""===e.outerText}e.exports=n},function(e,t){function n(e,t){if(e.offsetWidth<=0){if(y.test(l["@:get"](e,"display"))){var a={node:e};for(var r in m)a[r]=e.style[r],e.style[r]=m[r];t.push(a)}var o=e.parentNode;o&&1===o.nodeType&&n(o,t)}}function a(e){return e.window||e.defaultView||e.parentWindow||!1}var r=avalon.root,o=avalon.window,i=avalon.camelize,l=avalon.cssHooks,s=["","-webkit-","-o-","-moz-","-ms-"],c={"float":o.Range?"cssFloat":"styleFloat"};if(avalon.cssNumber=avalon.oneObject("animationIterationCount,columnCount,order,flex,flexGrow,flexShrink,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(e,t,n){if(c[e])return c[e];t=t||r.style||{};for(var a=0,o=s.length;o>a;a++)if(n=i(s[a]+e),n in t)return c[e]=n;return null},avalon.fn.css=function(e,t){if(avalon.isPlainObject(e))for(var n in e)avalon.css(this,n,e[n]);else var a=avalon.css(this,e,t);return void 0!==a?a:this},avalon.fn.position=function(){var e,t,n=this[0],a={top:0,left:0};return n?("fixed"===this.css("position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),"HTML"!==e[0].tagName&&(a=e.offset()),a.top+=avalon.css(e[0],"borderTopWidth",!0),a.left+=avalon.css(e[0],"borderLeftWidth",!0),a.top-=e.scrollTop(),a.left-=e.scrollLeft()),{top:t.top-a.top-avalon.css(n,"marginTop",!0),left:t.left-a.left-avalon.css(n,"marginLeft",!0)}):a},avalon.fn.offsetParent=function(){for(var e=this[0].offsetParent;e&&"static"===avalon.css(e,"position");)e=e.offsetParent;return avalon(e||r)},l["@:set"]=function(e,t,n){try{e.style[t]=n}catch(a){}},o.getComputedStyle)l["@:get"]=function(e,t){if(!e||!e.style)throw new Error("getComputedStyle要求传入一个节点 "+e);var n,a=getComputedStyle(e,null);return a&&(n="filter"===t?a.getPropertyValue(t):a[t],""===n&&(n=e.style[t])),n},l["opacity:get"]=function(e){var t=l["@:get"](e,"opacity");return""===t?"1":t};else{var u=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,v=/^(top|right|bottom|left)$/,f=/alpha\([^)]*\)/i,d=!!o.XDomainRequest,p="DXImageTransform.Microsoft.Alpha",h={thin:d?"1px":"2px",medium:d?"3px":"4px",thick:d?"5px":"6px"};l["@:get"]=function(e,t){var n=e.currentStyle,a=n[t];if(u.test(a)&&!v.test(a)){var r=e.style,o=r.left,i=e.runtimeStyle.left;e.runtimeStyle.left=n.left,r.left="fontSize"===t?"1em":a||0,a=r.pixelLeft+"px",r.left=o,e.runtimeStyle.left=i}return"medium"===a&&(t=t.replace("Width","Style"),"none"===n[t]&&(a="0px")),""===a?"auto":h[a]||a},l["opacity:set"]=function(e,t,n){var a=e.style,r=isFinite(n)&&1>=n?"alpha(opacity="+100*n+")":"",o=a.filter||"";a.zoom=1,a.filter=(f.test(o)?o.replace(f,r):o+" "+r).trim(),a.filter||a.removeAttribute("filter")},l["opacity:get"]=function(e){var t=e.filters.alpha||e.filters[p],n=t&&t.enabled?t.opacity:100;return n/100+""}}"top,left".replace(avalon.rword,function(e){l[e+":get"]=function(t){var n=l["@:get"](t,e);return/px$/.test(n)?n:avalon(t).position()[e]+"px"}});var m={position:"absolute",visibility:"hidden",display:"block"},y=/^(none|table(?!-c[ea]).+)/;avalon.each({Width:"width",Height:"height"},function(e,t){var a="client"+e,r="scroll"+e,o="offset"+e;l[t+":get"]=function(t,n,a){var r=-4;"number"==typeof a&&(r=a),n="Width"===e?["Left","Right"]:["Top","Bottom"];var i=t[o];return 2===r?i+avalon.css(t,"margin"+n[0],!0)+avalon.css(t,"margin"+n[1],!0):(0>r&&(i=i-avalon.css(t,"border"+n[0]+"Width",!0)-avalon.css(t,"border"+n[1]+"Width",!0)),-4===r&&(i=i-avalon.css(t,"padding"+n[0],!0)-avalon.css(t,"padding"+n[1],!0)),i)},l[t+"&get"]=function(e){var a=[];n(e,a);for(var r,o=l[t+":get"](e),i=0;r=a[i++];){e=r.node;for(var s in r)"string"==typeof r[s]&&(e.style[s]=r[s])}return o},avalon.fn[t]=function(n){var i=this[0];if(0===arguments.length){if(i.setTimeout)return i["inner"+e]||i.document.documentElement[a]||i.document.body[a];if(9===i.nodeType){var s=i.documentElement;return Math.max(i.body[r],s[r],i.body[o],s[o],s[a])}return l[t+"&get"](i)}return this.css(t,n)},avalon.fn["inner"+e]=function(){return l[t+":get"](this[0],void 0,-2)},avalon.fn["outer"+e]=function(e){return l[t+":get"](this[0],void 0,e===!0?2:0)}}),avalon.fn.offset=function(){var e=this[0],t={left:0,top:0};if(!e||!e.tagName||!e.ownerDocument)return t;var n=e.ownerDocument,a=n.body,r=n.documentElement,o=n.defaultView||n.parentWindow;if(!avalon.contains(r,e))return t;e.getBoundingClientRect&&(t=e.getBoundingClientRect());var i=r.clientTop||a.clientTop,l=r.clientLeft||a.clientLeft,s=Math.max(o.pageYOffset||0,r.scrollTop,a.scrollTop),c=Math.max(o.pageXOffset||0,r.scrollLeft,a.scrollLeft);return{top:t.top+s-i,left:t.left+c-l}},avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){avalon.fn[e]=function(n){var o=this[0]||{},i=a(o),l="scrollTop"===e;return arguments.length?void(i?i.scrollTo(l?avalon(i).scrollLeft():n,l?n:avalon(i).scrollTop()):o[e]=n):i?t in i?i[t]:r[e]:o[e]}})},function(e,t){function n(e){var t=e.tagName.toLowerCase();return"input"===t&&/checkbox|radio/.test(e.type)?"checked":t}var a=/^<option(?:\s+\w+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s>]+))?)*\s+value[\s=]/i,r={"option:get":avalon.msie?function(e){return a.test(e.outerHTML)?e.value:e.text.trim()}:function(e){return e.value},"select:get":function(e,t){for(var n,a=e.options,o=e.selectedIndex,i=r["option:get"],l="select-one"===e.type||0>o,s=l?null:[],c=l?o+1:a.length,u=0>o?c:l?o:0;c>u;u++)if(n=a[u],(n.selected||u===o)&&!n.disabled&&(!n.parentNode.disabled||"OPTGROUP"!==n.parentNode.tagName)){if(t=i(n),l)return t;s.push(t)}return s},"select:set":function(e,t,n){t=[].concat(t);for(var a,o=r["option:get"],i=0;a=e.options[i++];)(a.selected=t.indexOf(o(a))>-1)&&(n=!0);n||(e.selectedIndex=-1)}};avalon.fn.val=function(e){var t=this[0];if(t&&1===t.nodeType){var a=0===arguments.length,o=a?":get":":set",i=r[n(t)+o];if(i)var l=i(t,e);else{if(a)return(t.value||"").replace(/\r/g,"");t.value=e}}return a?l:this}},function(e,t,n){var a=n(28),r=n(29),o=/<|&#?\w+;/,i=new a(128),l=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi;avalon.parseHTML=function(e){var t=avalon.avalonFragment.cloneNode(!1);if("string"!=typeof e)return t;if(!o.test(e))return document.createTextNode(e);e=e.replace(l,"<$1></$2>").trim();var n=i.get(e);if(n)return r(n);for(var a,s=avalon.lexer(e,!1,1e3),c=0;a=s[c++];)t.appendChild(avalon.vdomAdaptor(a,"toDOM"));return e.length<1024&&i.put(e,r(t)),t},avalon.innerHTML=function(e,t){if(!avalon.modern&&!rcreate.test(t)&&!rnest.test(t))try{return void(e.innerHTML=t)}catch(n){}var a=this.parseHTML(t);this.clearHTML(e).appendChild(a)},avalon.clearHTML=function(e){for(e.textContent="";e.lastChild;)e.removeChild(e.lastChild);return e}},function(e,t){function n(e){this.size=0,this.limit=e,this.head=this.tail=void 0,this._keymap={}}var a=n.prototype;a.put=function(e,t){var n={key:e,value:t};return this._keymap[e]=n,this.tail?(this.tail.newer=n,n.older=this.tail):this.head=n,this.tail=n,this.size===this.limit?this.shift():this.size++,t},a.shift=function(){var e=this.head;e&&(this.head=this.head.newer,this.head.older=e.newer=e.older=this._keymap[e.key]=void 0,delete this._keymap[e.key])},a.get=function(e){var t=this._keymap[e];if(void 0!==t)return t===this.tail?t.value:(t.newer&&(t===this.head&&(this.head=t.newer),t.newer.older=t.older),t.older&&(t.older.newer=t.newer),t.newer=void 0,t.older=this.tail,this.tail&&(this.tail.newer=t),this.tail=t,t.value)},e.exports=n},function(e,t){function n(e,t){if(1===e.nodeType){var n=e.nodeName.toLowerCase();"object"===n?e.parentNode&&(e.outerHTML=t.outerHTML):"input"===n&&o.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===n?e.defaultSelected=e.selected=t.defaultSelected:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}}function a(e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName("*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll("*"):[]}function r(e){var t=e.cloneNode(!0);if(avalon.modern)return t;var r=a(t),o=a(e);return avalon.each(o,function(e){n(r[e],o[e])}),t}var o=/radio|checkbox/;e.exports=r},function(e,t,n){function a(e,t,n){var r=e.getAttribute("avalon-events");if(r&&(e.disabled!==!0||"click"!==t)){var o=[],i=p[t]||(p[t]=new RegExp(t+"\\:([^,\\s]+)","g"));r.replace(i,function(e,t){return o.push(t),e}),o.length&&n.push({elem:e,uuids:o})}e=e.parentNode;var l=avalon.gestureEvents||{};e&&e.getAttribute&&(f[t]||l[t])&&a(e,t,n)}function r(e){e=new i(e);var t=e.type,n=e.target,r=[];a(n,t,r);for(var o,l,s,c=0;(s=r[c++])&&!e.cancelBubble;){var u=e.currentTarget=s.elem;for(o=0;(l=s.uuids[o++])&&!e.isImmediatePropagationStopped;){var v=avalon.eventListeners[l];if(v){var f=h.test(l)?s.elem._ms_context_:0;if(f&&f.$hashcode===!1)return avalon.unbind(n,t,v);var d=v.call(f||n,e,u._ms_local);d===!1&&(e.preventDefault(),e.stopPropagation())}}}}function o(e){var t=c.getAttribute("delegate-events")||"";if(-1===t.indexOf(e)){
var n=t.match(avalon.rword)||[];n.push(e),c.setAttribute("delegate-events",n.join(",")),y(c,e,r,!!m[e])}}function i(e){if(e.originalEvent)return this;for(var t in e)b.test(t)||"function"==typeof e[t]||(this[t]=e[t]);this.target||(this.target=e.srcElement);var n=this.target;if(null==this.which&&0===e.type.indexOf("key"))this.which=null!=e.charCode?e.charCode:e.keyCode;else if(_.test(e.type)&&!("pageX"in this)){var a=n.ownerDocument||l,r="BackCompat"===a.compatMode?a.body:a.documentElement;this.pageX=e.clientX+(r.scrollLeft>>0)-(r.clientLeft>>0),this.pageY=e.clientY+(r.scrollTop>>0)-(r.clientTop>>0),this.wheelDeltaY=this.wheelDelta,this.wheelDeltaX=0}this.timeStamp=new Date-0,this.originalEvent=e}var l=avalon.document,s=avalon.window,c=avalon.root,u=avalon.modern,v=n(6).getShortID,f=n(31);u||(delete f.change,delete f.select);var d=avalon.eventHooks;avalon.bind=function(e,t,n){if(1===e.nodeType){var a=e.getAttribute("avalon-events")||"",i=v(n),l=d[t];l&&(t=l.type||t,l.fix&&(n=l.fix(e,n),n.uuid=i));var s=t+":"+i;avalon.eventListeners[n.uuid]=n,-1===a.indexOf(t+":")&&(f[t]||avalon.modern&&m[t]?o(t):y(e,t,r));var c=a.split(",");""===c[0]&&c.shift(),-1===c.indexOf(s)&&(c.push(s),e.setAttribute("avalon-events",c.join(",")))}else y(e,t,n);return n},avalon.unbind=function(e,t,n){if(1===e.nodeType){var a=e.getAttribute("avalon-events")||"";switch(arguments.length){case 1:g(e,t,r),e.removeAttribute("avalon-events");break;case 2:a=a.split(",").filter(function(e){return-1===e.indexOf(t+":")}).join(","),e.setAttribute("avalon-events",a);break;default:var o=t+":"+n.uuid;a=a.split(",").filter(function(e){return e!==o}).join(","),e.setAttribute("avalon-events",a),delete avalon.eventListeners[n.uuid]}}else g(e,t,n)};var p={},h=/^e/,m={focus:!0,blur:!0},y=u?function(e,t,n,a){e.addEventListener(t,n,a)}:function(e,t,n){e.attachEvent("on"+t,n)},g=u?function(e,t,n){e.removeEventListener(t,n)}:function(e,t,n){e.detachEvent("on"+t,n)};avalon.fireDom=function(e,t,n){if(l.createEvent){var a=l.createEvent("Events");a.initEvent(t,!0,!0,n),avalon.shadowCopy(a,n),e.dispatchEvent(a)}else c.contains(e)&&(a=l.createEventObject(),avalon.shadowCopy(a,n),e.fireEvent("on"+t,a))};var _=/^(?:mouse|contextmenu|drag)|click/,b=/^(?:ms|webkit|moz)/;if(i.prototype={preventDefault:function(){var e=this.originalEvent;this.returnValue=!1,e&&(e.returnValue=!1,e.preventDefault&&e.preventDefault())},stopPropagation:function(){var e=this.originalEvent;this.cancelBubble=!0,e&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=!0,e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},"onmouseenter"in c||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){d[e]={type:t,fix:function(t,n){return function(a){var r=a.relatedTarget;return r&&(r===t||16&t.compareDocumentPosition(r))?void 0:(delete a.type,a.type=e,n.apply(this,arguments))}}}}),avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(e,t){s[e]&&!d.animationend&&(d.animationend={type:t})}),"oninput"in l.createElement("input")||(d.input={type:"propertychange",fix:function(e,t){return function(e){return"value"===e.propertyName?(e.type="input",t.apply(this,arguments)):void 0}}}),void 0===l.onmousewheel){var w=void 0!==l.onwheel?"wheel":"DOMMouseScroll",x="wheel"===w?"deltaY":"detail";d.mousewheel={type:w,fix:function(e,t){return function(n){var a=n[x]>0?-120:120;return n.wheelDelta=~~e._ms_wheel_+a,e._ms_wheel_=n.wheelDeltaY=n.wheelDelta,n.wheelDeltaX=0,Object.defineProperty&&Object.defineProperty(n,"type",{value:"mousewheel"}),t.apply(this,arguments)}}}}avalon.fn.bind=function(e,t,n){return this[0]?avalon.bind(this[0],e,t,n):void 0},avalon.fn.unbind=function(e,t,n){return this[0]&&avalon.unbind(this[0],e,t,n),this},avalon.$$unbind=function(e){var t=e.getElementsByTagName("*");avalon.each(t,function(e,t){1===t.nodeType&&t.getAttribute("avalon-events")&&avalon.unbind(t)})}},function(e,t){e.exports={click:!0,dblclick:!0,keydown:!0,keypress:!0,keyup:!0,mousedown:!0,mousemove:!0,mouseup:!0,mouseover:!0,mouseout:!0,wheel:!0,mousewheel:!0,input:!0,change:!0,beforeinput:!0,compositionstart:!0,compositionupdate:!0,compositionend:!0,select:!0,cut:!0,copy:!0,paste:!0,beforecut:!0,beforecopy:!0,beforepaste:!0,focusin:!0,focusout:!0,DOMFocusIn:!0,DOMFocusOut:!0,DOMActivate:!0,dragend:!0,datasetchanged:!0}},function(e,t,n){function a(){try{s.doScroll("left"),u()}catch(e){setTimeout(a)}}var r,o=n(33),i=avalon.document,l=avalon.window,s=avalon.root,c=[],u=function(e){for(r=!0;e=c.shift();)e(avalon)};if("complete"===i.readyState)setTimeout(u);else if(i.addEventListener)i.addEventListener("DOMContentLoaded",u);else if(i.attachEvent){i.attachEvent("onreadystatechange",function(){"complete"===i.readyState&&u()});try{var v=null===l.frameElement}catch(f){}s.doScroll&&v&&l.external&&a()}l.document&&avalon.bind(l,"load",u),avalon.ready=function(e){r?e(avalon):c.push(e)},avalon.ready(function(){o(i.body)})},function(e,t,n){function a(e){for(var t,n=0;t=e[n++];)if(1===t.nodeType){var i=r(t),l=avalon.vmodels[i];if(l&&!l.$element){avalon(t).removeClass("ms-controller"),l.$element=t;var s=new Date,c=o(t);t.vtree=avalon.lexer(c),avalon.speedUp(t.vtree);var u=new Date;avalon.log("构建虚拟DOM耗时",u-s,"ms"),l.$render=avalon.render(t.vtree),avalon.scopes[l.$id]={vmodel:l,local:{}};var v=new Date;avalon.log("构建当前vm的$render方法耗时 ",v-u,"ms\n","如果此时间太长,达100ms以上\n","建议将当前ms-controller拆分成多个ms-controlelr,减少每个vm管辖的区域"),avalon.rerenderStart=v,avalon.batch(i)}else i||a(t.childNodes)}}function r(e){return e.getAttribute("ms-controller")||e.getAttribute("ms-important")}var o=n(34);e.exports=avalon.scan=function(e){return e&&e.nodeType?void a([e]):void avalon.warn("[avalon.scan] first argument must be element , documentFragment, or document")}},function(e,t){function n(e){switch(e.nodeType){case 1:var t=e.nodeName.toLowerCase();return"<"+t+a(e.attributes)+(i[t]?"/>":">"+r(e)+"</"+t+">");case 3:return e.nodeValue;case 8:return"<!--"+e.nodeValue+"-->"}}function a(e){for(var t,n=[],a=0;t=e[a++];)t.specified&&n.push(t.name.toLowerCase()+'="'+o(t.value)+'"');var r=n.join(" ");return r?" "+r:""}function r(e){for(var t,a="",r=0;t=e.childNodes[r++];)a+=n(t);return a}function o(e){var t=""+e,n=l.exec(t);if(!n)return t;var a,r="",o=0,i=0;for(o=n.index;o<t.length;o++){switch(t.charCodeAt(o)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 39:a="&#39;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}i!==o&&(r+=t.substring(i,o)),i=o+1,r+=a}return i!==o?r+t.substring(i,o):r}var i=avalon.oneObject("area,base,basefont,br,col,command,embed,hr,img,input,link,meta,param,source,track,wbr"),l=/["'&<>]/;e.exports=n},function(e,t,n){n(36),n(38),n(39),n(40),n(41),n(42),n(43),n(44),n(53),n(54),n(55),n(62),n(63),n(64),n(65),n(66),n(69)},function(e,t,n){var a=n(37);avalon.directive("important",{priority:1,parse:function(e,t,n){var a=avalon.quote(n.expr);e[n.name]=a,e.local="{}",e.vmodel="(function(){ return __vmodel__ = avalon.vmodels["+a+"]})()",t.$prepend=["(function(__vmodel__){","var important = avalon.scopes["+a+"]",'if(important && important.fast){avalon.log("不进入"+'+a+");return }"].join("\n")+"\n",t.$append="\n})();"},diff:function(e,t,n){t.vmodel!==e.vmodel&&(t["ms-controller"]=e[n],t.local=e.local,t.vmodel=e.vmodel,a(t,this.update))},update:function(e,t,n){avalon.directives.controller.update(e,t,n,"important")}})},function(e,t){e.exports=function(e,t,n){if(n)e.afterChange=e.afterChange||[],avalon.Array.ensure(e.afterChange,t);else{var a=e.dom;t(e.dom,e,a&&a.parentNode)}}},function(e,t,n){var a=n(37),r={};avalon.mediatorFactoryCache=function(e,t){var n=e.$hashcode,a=t.$hashcode,o=n+a;if(r[o])return r[o];var i=avalon.mediatorFactory(e,t);return r[o]=i},avalon.directive("controller",{priority:2,parse:function(e,t,n){var a=avalon.quote(n.expr);e[n.name]=a,e.local="__local__",e.vmodel=["(function(){","var vm = avalon.vmodels["+a+"]","if(vm && __vmodel__&& vm !== __vmodel__){","return __vmodel__ = avalon.mediatorFactoryCache(__vmodel__, vm)","}else if(vm){","return __vmodel__ = vm","}","})()"].join("\n"),t.$prepend="(function(__vmodel__){",t.$append="\n})(__vmodel__);"},diff:function(e,t,n){t[n]!==e[n]&&(t[n]=e[n],t.local=e.local,t.vmodel=e.vmodel,a(t,this.update))},update:function(e,t,n,a){var r=t.vmodel,o=t.local,i=t["ms-controller"],l=avalon.scopes[i];if(!l||a&&!a.fast){delete t.vmodel,delete t.local;var s=avalon.vmodels[i],c=avalon.render([t],o);r.$render=c,r.$element=e,e.vtree=[t],s!==r&&(s.$render=s.$render||c,s.$element=s.$element||e),avalon.scopes[i]={vmodel:r,local:o,fast:"important"}}}})},function(e,t,n){var a=n(22),r=n(37);avalon.directive("attr",{diff:function(e,t,n){var a=e[n],o=t[n];if(a&&"object"==typeof a){if(a=a.$model||a,Array.isArray(a)&&(a=avalon.mix.apply({},a)),"object"!=typeof o)t.changeAttr=t[n]=a;else{var i={},l=!1;for(var s in a)a[s]!==o[s]&&(l=!0,i[s]=a[s]);l&&(t[n]=a,t.changeAttr=i)}t.changeAttr&&r(t,this.update)}delete e[n]},update:a})},function(e,t,n){var a=n(37);avalon.directive("css",{diff:function(e,t,n){var r=e[n],o=t[n];if(Object(r)===r){if(r=r.$model||r,Array.isArray(r)&&(r=avalon.mix.apply({},r)),"object"!=typeof o)t.changeStyle=t[n]=r;else{var i={},l=!1;for(var s in r)r[s]!==o[s]&&(l=!0,i[s]=r[s]);l&&(t[n]=r,t.changeStyle=i)}t.changeStyle&&a(t,this.update)}delete e[n]},update:function(e,t){var n=t.changeStyle,a=avalon(e);for(var r in n)a.css(r,n[r]);delete t.changeStyle}})},function(e,t,n){function a(e,t){var n=e.ownerDocument,r=e.nodeName,i="_"+r;if(!a[i]){var l=n.body.appendChild(n.createElement(r));t=avalon.modern?getComputedStyle(l,null).display:l.currentStyle.display,n.body.removeChild(l),t===o&&(t="block"),a[i]=t}return a[i]}var r=n(37),o="none";avalon.parseDisplay=a,avalon.directive("visible",{diff:function(e,t,n){var a=!!e[n];a!==t[n]&&(t[n]=a,r(t,this.update))},update:function(e,t){function n(){void 0!==r&&(e.style.display=r)}if(e&&1===e.nodeType){var r,i=t["ms-visible"],l=e.style.display;i?(l===o&&(r=t.displayValue,r||(e.style.display="")),""===e.style.display&&avalon(e).css("display")===o&&avalon.contains(e.ownerDocument,e)&&(r=a(e))):l!==o&&(r=o,t.displayValue=l),avalon.applyEffect(e,t,{hook:i?"onEnterDone":"onLeaveDone",cb:n})}}})},function(e,t,n){var a=n(37);avalon.directive("expr",{parse:avalon.noop,diff:function(e,t){var n=e.nodeValue+"";n!==t.nodeValue&&(t.nodeValue=n,a(t,this.update))},update:function(e,t){e.nodeValue=t.nodeValue}})},function(e,t){avalon.directive("text",{parse:function(e,t,n){e[n.name]=1,t.children=[],e.children='[{\nnodeType:3,\ntype:"#text",\ndynamic:true,\nnodeValue:avalon.parsers.string('+avalon.parseExpr(n)+")}]"},diff:function(e,t,n){if(t.dom&&!t.isVoidTag&&!t.children.length){for(var a=t.dom;a.firstChild;)a.removeChild(a.firstChild);var r=document.createTextNode("x");a.appendChild(r);var o={nodeType:3,type:"#text",dom:r};t.children.push(o)}},update:avalon.noop})},function(e,t,n){var a=n(37),r=(n(45),n(52));avalon.directive("html",{parse:function(e,t,n){t.isVoidTag?e.children="[]":(e[n.name]=avalon.parseExpr(n),e.vmodel="__vmodel__",e.local="__local__")},diff:function(e,t,n){var r=e[n]+"";if(r!==t[n]){t[n]=r;var o=avalon.lexer(r);avalon.speedUp(o),t.children=o;var i=avalon.render(o,e.local);t.render=i;var l=i(e.vmodel,e.local);e.children=l,a(t,this.update)}else{var l=t.render(e.vmodel,e.local);e.children=l}},update:function(e,t,n){avalon.clearHTML(e);var a=avalon.vdomAdaptor(t.children);r(a.childNodes,t.children,a),e.appendChild(a)}})},function(e,t,n){function a(e){return m.test(e)?e:c(e,"text")}function r(e){return"vnodes.push("+e+");"}function o(e){return r(f(e))}function i(e,t){for(var n,a=t?[]:["\nvar vnodes = [];"],r=0;n=e[r++];){var o=l(n);n.$prepend&&a.push(n.$prepend);var i=n.$append;delete n.$append,delete n.$prepend,o&&a.push(o+"\n"),i&&a.push(i)}return t||a.push("return vnodes\n"),a.join("\n")}function l(e){var t=avalon.directives;if(3===e.nodeType)return d.rexpr.test(e.nodeValue)?r(s(e)):o(e);if(1===e.nodeType){var n={props:{},type:e.type,nodeType:1},a=u(n,e.props);if(n.order=a.map(function(a){return t[a.type].parse(n,e,a),a.name}).join(","),e.isVoidTag)n.isVoidTag=!0;else if(!("children"in n)){var l=e.children;l.length?n.children="(function(){"+i(l)+"})()":n.children="[]"}return e.skipContent&&(n.skipContent=!0),e.skipAttrs&&(n.skipAttrs=!0),o(n)}if(8===e.nodeType){var v=e.nodeValue;if(y.test(v)){0!==v.indexOf("ms-for:")&&avalon.error("ms-for指令前不能有空格");var n={dynamic:"for",vmodel:"__vmodel__"};for(var f in e)e.hasOwnProperty(f)&&(n[f]=e[f]);return t["for"].parse(n,e,e),o(n)}if(g.test(v))return 0!==v.indexOf("ms-for-end:")&&avalon.error("ms-for-end指令前不能有空格"),e.$append=o({nodeType:8,type:"#comment",nodeValue:e.signature,key:"traceKey"})+"\n},__local__,vnodes)\n"+o({nodeType:8,type:"#comment",signature:e.signature,nodeValue:"ms-for-end:"})+"\n","";if(0===v.indexOf("ms-js:")){var p=c(v.replace("ms-js:",""),"js")+"\n",h=o(e),m=p.match(_);return m&&m[1]?e.$append=(e.$append||"")+p+"\n__local__."+m[1]+" = "+m[1]+"\n":avalon.warn(v+" parse fail!"),h}return o(e)}Array.isArray(e)&&(e.$append=i(e,!0))}function s(e){var t=v(e.nodeValue),n="";if(1===t.length)n=a(t[0].expr);else{var r=t.map(function(e){return e.type?a(e.expr):p(e.expr)}).join(" + ");n="String("+r+")"}return'{\ntype: "#text",\nnodeType:3,\ndynamic:true,\nnodeValue: '+n+"\n}"}var c=n(46),u=n(49),v=n(50),f=n(51),d=avalon.config,p=avalon.quote,h=(avalon.makeHashCode,n(48)),m=h.ident,y=(h.sp,/^\s*ms\-for:/),g=/^\s*ms\-for\-end:/,_=/^\s*var\s+([$\w]+)\s*\=\s*\S+/;e.exports=i},function(e,t,n){function a(e,t){var n=e.replace(y,"").match(g);n&&n.filter(function(e){/^[@\d\-]/.test(e)||"##"===e.slice(0,2)||"$event"===e||avalon.keyMap[e]||(t[e]=1)})}function r(e){var t=[];for(var n in e)t.push("var "+n+" = __local__["+avalon.quote(n)+"]");return t}function o(e,t){function n(e){var t="??"+x++;return $[t]=e,t}function o(e){return $[e]}var y={};if(t=t||"other","object"==typeof e&&(t=e.type,y=e,e=y.expr),"string"!=typeof e)return"";var g=e,b=l.get(t+":"+g);if(b)return b;var x=1,$={},T=e.replace(s,n).replace(c,n).replace(_,w).replace(f,n).replace(p,"$1").split(d),A=T.shift(),C={},k=A.replace(u,o).trim();if("on"===t&&m.test(k)&&(k+="($event)"),k=k.replace(h,"$1__vmodel__."),"js"===t)return l.put(t+":"+g,k);"on"===t&&a(A,C);var E=T.map(function(e){a(e.replace(/^\w+/g,""),C),e=e.replace(u,o).replace(h,"$1__vmodel__.");var t=!1;return e=e.replace(v,function(e,n){return t=!0,/\S/.test(n)?"(__value__,"+n+");":"(__value__);"}),t||(e+="(__value__);"),e=e.replace(/(\w+)/,'avalon.__format__("$1")'),"__value__ = "+e}),O=[];if("on"===t)E=E.map(function(e){return e.replace(/__value__/g,"$event")}),E.length&&E.push("if($event.$return){\n	return;\n}"),avalon.modern||(k=k.replace(/__vmodel__\.([^(]+)\(([^)]*)\)/,function(e,t,n){return"__vmodel__."+t+".call(__vmodel__"+(/\S/.test(n)?","+n:"")+")"})),O=["function ms_on($event, __local__){","try{",r(C).join("\n"),"	var __vmodel__ = this;","	"+k,"}catch(e){",i(e,t),"}","}"],E.unshift(2,0);else{if("duplex"===t){var M=["function (__vmodel__){","try{","return "+k+"\n","}catch(e){",i(e,t).replace("parse","get"),"}","}"];l.put("duplex:"+g,M.join("\n"));var S=["function (__vmodel__,__value__){","try{","	"+k+" = __value__","}catch(e){",i(e,t).replace("parse","set"),"}","}"];if(l.put("duplex:set:"+g,S.join("\n")),T.length){var j=["function (__vmodel__, __value__){","try{",E.join("\n"),"return __value__\n","}catch(e){",i(e,t).replace("parse","format"),"}","}"];l.put("duplex:format:"+g,j.join("\n"))}return l.get("duplex:"+g)}O=["(function(){","try{","var __value__ = "+k,"text"===t?"return avalon.parsers.string(__value__)":"return __value__","}catch(e){",i(e,t),'	return ""',"}","})()"],E.unshift(3,0)}return O.splice.apply(O,E),b=O.join("\n"),l.put(t+":"+g,b),b}function i(e,t){return"	avalon.warn(e, "+avalon.quote("parse "+t+" binding【 "+e+" 】fail")+")"}var l=n(47),s=/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/g,c=n(48).string,u=/\?\?\d+/g,v=/\(([^)]*)\)/,f=/\|\|/g,d=/\|(?=\w)/,p=/\s*(\.|\|)\s*/g,h=/(^|[^\w\u00c0-\uFFFF_])(@|##)(?=[$\w])/g,m=/^(?:\@|##)[$\w]+$/i,y=/\|.+/g,g=/((?:\@|\$|\#\#)?\w+)/g;e.exports=avalon.parseExpr=o;var _=/&(quot|lt|gt|amp|#\d+);/g,b={quot:'"',lt:"<",gt:">",amp:"&"},w=function(e,t){return b[t]?b[t]:b[t]=String.fromCharCode(parseInt(t.slice(1),10))}},function(e,t,n){var a=n(28);e.exports=new a(512)},function(e,t){e.exports={ident:/^[$a-zA-Z_][$a-zA-Z0-9_]*$/,sp:/^\s+$/,leftSp:/^\s+/,rightSp:/s+$/,binding:/^ms-(\w+)-?(.*)/,string:/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/g}},function(e,t,n){function a(e,t){var n=[],a="ms-skip"in t,s={};for(var c in t){var u,v=t[c];if(!a&&(u=c.match(i))){var f=u[1],d=u[2]||"",p=c;if(l[f]){var h=parseFloat(d)||0;d=f,f="on"}if(p="ms-"+f+(d?"-"+d:""),c!==p&&(delete t[c],t[p]=v),o[f]){var m={type:f,param:d,name:p,expr:v,priority:o[f].priority||100*f.charCodeAt(0)};"on"===f&&(h=h||0,m.name+="-"+h,m.priority+=100*d.charCodeAt(0)+h),s[m.name]||(s[m.name]=1,n.push(m))}}else e.props[c]=t[c]}return n.sort(r),n}function r(e,t){return e.priority-t.priority}var o=avalon.directives,i=n(48).binding,l=avalon.oneObject("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit");e.exports=a},function(e,t,n){function a(e){for(var t,n,a=[],l=0;;){if(n=e.indexOf(i.openTag,l),-1===n)break;if(t=e.slice(l,n),0===l&&(t=t.replace(o.leftSp,"")),t&&a.push({expr:t}),l=n+i.openTag.length,n=e.indexOf(i.closeTag,l),-1===n)break;t=e.slice(l,n),t&&a.push({expr:t.replace(r,""),type:"{{}}"}),l=n+avalon.config.closeTag.length}t=e.slice(l);var s=t.replace(o.rightSp,"");return s&&a.push({expr:s.replace(/^\s+$/," ")}),a}var r=/\r?\n/g,o=n(48),i=avalon.config;e.exports=a},function(e,t){function n(e){return i.test(e)||r[e]?l(e):e}function a(e){var t=[];for(var a in e)if("props"===a){var r=[];for(var i in e.props){var s=e.props[i];"string"==typeof s&&(s=l(s)),r.push(n(i)+": "+s)}t.push("props: {"+r.join(",\n")+"}")}else if(e.hasOwnProperty(a)){var c=e[a];"string"==typeof c&&(c=o[a]?l(c):c),t.push(n(a)+":"+c)}return"{\n"+t.join(",\n")+"}"}var r=avalon.oneObject("break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile");avalon.keyMap=r;var o={type:1,template:1,innerHTML:1,outerHTML:1,order:1,nodeValue:1,dynamic:1,signature:1,wid:1,cid:1},i=/[W-]/,l=avalon.quote;e.exports=a},function(e,t){function n(e){switch(e.nodeType){case 3:return"3"+(/[\S\xA0]/.test(e.nodeValue)?"retain":"remove");case 1:return"1"+(e.nodeName||e.type).toLowerCase();case 8:return"8"+e.nodeValue}}function a(e,t,l){t=r(t);var s={},c=t.length;if(0!==c){t.forEach(function(e,t){s[t]=n(e)});for(var u,v=[],f=!1,d=0,p=0;;){if(u=e[d++],p++>5e3)break;var h=u&&n(u),m=v.length;if(s[m]===h){v.push(u);var y=t[m];if(y.dynamic&&(y.dom=u),1===u.nodeType&&!y.isVoidTag&&!i[y.type]){if("select-one"===u.type)var g=u.selectedIndex;a(u.childNodes,y.children,u),"select-one"===u.type&&(u.selectedIndex=g)}}else if(f=!0,o.test(s[m])){var _=t[m],b=document.createComment(_.nodeValue);_.dom=b,v.push(b),d=Math.max(0,--d)}if(v.length===c)break}if(f){for(var w=document.createDocumentFragment(),d=0;u=v[d++];)w.appendChild(u);for(;l.firstChild;)l.removeChild(l.firstChild);l.appendChild(w)}}}function r(e){for(var t,n=[],a=0;t=e[a];a++)Array.isArray(t)?n=n.concat(r(t)):n.push(t);return n}var o=/^8ms\-for/,i=avalon.oneObject("script,style,xmp,template,noscript,textarea");e.exports=a},function(e,t,n){function a(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t],r=typeof n;if("string"===r||"number"===r||n===!0)e.push(n);else if(Array.isArray(n))e.push(a.apply(null,n));else if("object"===r)for(var o in n)n.hasOwnProperty(o)&&n[o]&&e.push(o)}return e.join(" ")}function r(e){var t=e.target;avalon(t).addClass(t.getAttribute(u[e.type])||"")}function o(e){var t=e.target,n=u[e.type];avalon(t).removeClass(t.getAttribute(n)||""),"change-active"!==n&&avalon(t).removeClass(t.getAttribute("change-active")||"")}function i(e,t){var n=e.getAttribute("old-change-class"),a=t["ms-class"];n!==a&&(avalon(e).removeClass(n).addClass(a),e.setAttribute("old-change-class",a))}var l=n(6).getLongID,s=n(37),c=avalon.directives;avalon.directive("class",{diff:function(e,t,n){var i=n.slice(3),l=e[n],c=t[n]||"";if(!t.classEvent){var u={};"hover"===i?(u.mouseenter=r,u.mouseleave=o):"active"===i&&(t.props.tabindex=e.props.tabindex||-1,u.tabIndex=t.props.tabindex,u.mousedown=r,u.mouseup=o,u.mouseleave=o),t.classEvent=u}var v=a(l),f={},d=[];v.replace(/\S+/g,function(e){f[e]||(f[e]=1,d.push(e))}),v=d.join(" "),c!==v&&(t[n]=v,t["change-"+i]=v,s(t,this.update,i))},update:function(e,t){if(e&&1===e.nodeType){var n=t.classEvent;if(n){for(var a in n)"tabIndex"===a?e[a]=n[a]:avalon.bind(e,a,n[a]);t.classEvent={}}var r=["class","hover","active"];r.forEach(function(n){var a="change-"+n,r=t[a];if(void 0!==r)if("class"===n)e&&i(e,t);else{var o=e.getAttribute("change-"+n);o&&avalon(e).removeClass(o),e.setAttribute(a,r)}})}}}),c.active=c.hover=c["class"];var u={mouseenter:"change-hover",mouseleave:"change-hover",mousedown:"change-active",mouseup:"change-active"};l(r),l(o)},function(e,t,n){function a(e,t){for(var n in e)if(e[n]!==t[n])return!0;return!1}var r=(n(6).getLongID,n(28)),o=(new r(128),avalon.quote,n(37));n(48).string;avalon.directive("on",{priority:3e3,parse:function(e,t,n){var a=n.name.replace("ms-on-","e").replace("-","_"),r=a+"_"+n.expr.replace(/\s/g,"").replace(/[^$a-z]/gi,function(e){return e.charCodeAt(0)}),o=avalon.quote(r),i="(function(){\nvar fn610 = "+avalon.parseExpr(n,"on")+"\nfn610.uuid ="+o+";\nreturn fn610})()";e.vmodel="__vmodel__",e.local="__local__",e[n.name]=i},diff:function(e,t,n){var r=e[n],i=r.uuid,l=i.split("_").shift(),s=l.slice(1)+":"+i,c=t[n],u=!1;c&&c.uuid===i||(t[n]=r,t.addEvents=t.addEvents||{},t.addEvents[s]=r,avalon.eventListeners.uuid=r,u=!0),a(t.local||{},e.local)&&(u=!0),u&&(t.local=e.local,t.vmodel=e.vmodel,o(t,this.update))},update:function(e,t){if(e&&!(e.nodeType>1)){var n,a,r;e._ms_context_=t.vmodel,e._ms_local=t.local;for(n in t.addEvents)a=n.split(":").shift(),r=t.addEvents[n],avalon.bind(e,a,r);delete t.addEvents}}})},function(e,t,n){function a(e){for(var t,n=0;t=this.parser[n++];){var a=avalon.parsers[t];a&&(e=a.call(this,e))}return e}var r=n(37),o=n(47),i=n(51),l=/\|\s*change\b/,s=/^(?:checkbox|radio)$/,c=/\|\s*debounce(?:\(([^)]+)\))?/,u=n(56),v=n(59),f=n(57),d=n(60),p=n(61);avalon.directive("duplex",{priority:2e3,parse:function(e,t,n){var a,r=n.expr,u=t.props.type,v=n.param,f=!1;v=v?v.split("-").map(function(e){return"checked"===e&&(f=!0),e}):[],s.test(u)&&f&&(v=[],a="radio"),/input|textarea|select/.test(t.type)?a||(a="select"===t.type?"select":"checkbox"===u?"checkbox":"radio"===u?"radio":"input"):"contenteditable"in t.props&&(a="contenteditable");var d=!1,p=0;if("input"===a||"contenteditable"===a){var h=!0;if(l.test(r)&&(d=!0),!d){var m=r.match(c);m&&(p=parseInt(m[1],10)||300)}}var y=e.props["data-duplex-changed"];e.parser=avalon.quote(v+""),e.modelValue="("+avalon.parseExpr(n,"duplex")+")(__vmodel__)";var g=o.get("duplex:format:"+r);e.duplexData=i({type:a,vmodel:"__vmodel__",isChecked:f,isString:!!h,isChanged:d,debounceTime:p,format:g||"function(vm, a){return a}",set:o.get("duplex:set:"+r),callback:y?avalon.parseExpr(y,"on"):"avalon.noop"})},diff:function(e,t){if(t.duplexData){i=t.duplexData;var n=e.modelValue,o=i.modelValue;if(!Array.isArray(n)&&n===o)return}else{var i=t.duplexData=e.duplexData;i.parser=e.parser?e.parser.split(","):[],i.parse=a;var n=e.modelValue}if(e.duplexData=0,i.isString){var l=i.parse(n);if(l!==n)return void i.set(i.vmodel,l);n=l}if(i.modelValue=n,i.isString){if(l=i.format(i.vmodel,n+""),l!==n+"")return void i.set(i.vmodel,l);n=l}i.viewValue=n,r(t,this.update,"afterChange")},update:function(e,t){if(e&&1===e.nodeType){e.__ms_duplex__||(e.__ms_duplex__=t.duplexData,u(e,t));var n=e.__ms_duplex__;if(n.dom=e,p(e,t),n.isString&&!avalon.msie&&v===!1&&!e.valueHijack){e.valueHijack=f;var a=setInterval(function(){avalon.contains(avalon.root,e)?e.valueHijack():clearInterval(a)},30)}d[n.type].call(n)}}})},function(e,t,n){function a(e,t){var n={},a=t.duplexData;switch(a.update=v,a.type){case"radio":case"checkbox":n.click=v;break;case"select":n.change=v;break;case"contenteditable":a.isChanged?n.blur=v:avalon.modern?(p.webkitURL?n.webkitEditableContentChanged=v:p.MutationEvent&&(n.DOMCharacterDataModified=v),n.input=v):(n.keydown=u,n.paste=o,n.cut=o,n.focus=c,n.blur=s);break;case"input":a.isChanged?n.change=v:(d&&(n.keyup=u),9>d?(n.propertychange=r,n.paste=o,n.cut=o):n.input=v,(!d||d>9)&&(n.compositionstart=s,n.compositionend=c),d||/\[native code\]/.test(p.Int8Array)||(n.keydown=u,n.paste=o,n.cut=o,p.netscape&&(n.DOMAutoComplete=v)))}/password|text/.test(t.props.type)&&(n.focus=i,n.blur=l,a.getCaret=g,a.setCaret=y);for(var f in n)avalon.bind(e,f,n[f])}function r(e){"value"===e.propertyName&&v.call(this,e)}function o(e){var t=this;setTimeout(function(){v.call(t,e)},0)}function i(){this.caret=!0}function l(){this.caret=!1}function s(){this.composing=!0}function c(e){this.composing=!1,o.call(this,e)}function u(e){var t=e.keyCode;91===t||t>15&&19>t||t>=37&&40>=t||v.call(this,e)}var v=n(57),f=n(6).getShortID,d=avalon.msie,p=avalon.window,h=avalon.document;f(i),f(l),f(s),f(c),f(v),f(r),f(o),f(u);var m=function(e){setTimeout(e,0)},y=function(e,t){var n;e.createTextRange?m(function(){e.focus(),n=e.createTextRange(),n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",t),n.select()}):(e.focus(),void 0!==e.selectionStart&&e.setSelectionRange(t,t))},g=function(e){var t,n,a,r,o,i=0;return"number"==typeof e.selectionStart&&"number"==typeof e.selectionEnd?i=e.selectionStart:(n=h.selection.createRange(),n&&n.parentElement()==e&&(r=e.value.length,t=e.value.replace(/\r\n/g,"\n"),a=e.createTextRange(),a.moveToBookmark(n.getBookmark()),o=e.createTextRange(),o.collapse(!1),a.compareEndPoints("StartToEnd",o)>-1?i=r:(i=-a.moveStart("character",-r),i+=t.slice(0,i).split("\n").length-1))),i};e.exports=a},function(e,t,n){function a(e){var t=this,n=this.__ms_duplex__;if(!t.composing&&t.value!==n.lastViewValue){if(t.caret)try{var a=n.getCaret(t);n.pos=a}catch(e){avalon.warn("fixCaret error",e)}if(n.debounceTime>4){var o=new Date,i=o-n.time||0;n.time=o,i>=n.debounceTime?r[n.type].call(n):(clearTimeout(n.debounceID),n.debounceID=setTimeout(function(){r[n.type].call(n)},i))}else r[n.type].call(n)}}var r=n(58);e.exports=a},function(e,t){function n(e){e.callback&&e.callback.call(e.vmodel,{type:"changed",target:e.dom})}var a={input:function(e){var t=this;e=e||"value";var a=t.dom,r=a[e],o=t.parse(r),i=t.format(t.vmodel,o);t.lastViewValue=i,o!==t.modelValue&&(t.set(t.vmodel,o),n(t)),a[e]=i;var l=t.pos;a.caret&&t.setCaret(a,l)},radio:function(){var e=this;if(e.isChecked){var t=!e.modelValue;e.set(e.vmodel,t),n(e)}else a.input.call(e),e.lastViewValue=NaN},checkbox:function(){var e=this,t=e.modelValue;Array.isArray(t)||(avalon.warn("ms-duplex应用于checkbox上要对应一个数组"),t=[t]);var a=e.dom.checked?"ensure":"remove";if(t[a]){var r=e.parse(e.dom.value);t[a](r),n(e)}},select:function(){var e=this,t=avalon(e.dom).val();t+""!=this.modelValue+""&&(t=Array.isArray(t)?t.map(function(t){return e.parse(t)}):e.parse(t),e.set(e.vmodel,t),n(e))},contenteditable:function(){a.input.call(this,"innerHTML")}};e.exports=a},function(e,t){function n(e){r[this.tagName].call(this,e),!this.caret&&this._ms_field_&&this._ms_field_.update.call(this)}var a=!1;try{var r={},o=HTMLInputElement.prototype,i=HTMLTextAreaElement.prototype,l=HTMLInputElement.prototype;Object.getOwnPropertyNames(l),r.INPUT=Object.getOwnPropertyDescriptor(o,"value").set,Object.defineProperty(o,"value",{set:n}),r.TEXTAREA=Object.getOwnPropertyDescriptor(i,"value").set,Object.defineProperty(i,"value",{set:n}),a=!0}catch(s){}e.exports=a},function(e,t){var n={input:function(){this.dom.value=this.viewValue},radio:function(){var e;e=this.isChecked?!!this.modelValue:this.viewValue+""===this.dom.value;var t=this.dom;6===avalon.msie?setTimeout(function(){t.defaultChecked=e,t.checked=e},31):t.checked=e},checkbox:function(){for(var e=!1,t=this.dom,n=t.value,a=0;a<this.modelValue.length;a++){var r=this.modelValue[a];r+""===n&&(e=!0)}t.checked=e},select:function(){var e=Array.isArray(this.viewValue)?this.viewValue.map(String):this.viewValue+"";avalon(this.dom).val(e)},contenteditable:function(){this.dom.innerHTML=this.viewValue,this.update.call(this.dom)}};e.exports=n},function(e,t){e.exports=function(e,t){var n=e.__ms_duplex__,a=t["ms-rules"];if(a&&!n.validator)for(;e&&1===e.nodeType;){var r=e._ms_validator_;if(r){n.rules=a,n.validator=r,avalon.Array.ensure(r.fields,n)&&r.addField(n);break}e=e.parentNode}}},function(e,t,n){function a(){var e=this.data||{};return this.message.replace(i,function(t,n){return null==e[n]?"":e[n]})}var r=n(37),o=avalon.directive("validate",{diff:function(e,t,n){var a=e[n],i=t[n];if(!(i&&i.onError&&i.addField)&&Object(a)===a){t.vmValidator=a,a.$id&&(a=a.$model),t[n]=a;for(var n in o.defaults)a.hasOwnProperty(n)||(a[n]=o.defaults[n]);a.fields=a.fields||[],r(t,this.update)}},update:function(e,t){function n(){o.validateAll.call(a,a.onValidateAll)}var a=t["ms-validate"];e._ms_validator_=a,a.dom=e;var r=t.vmValidator;try{r.onManual=n}catch(i){}delete t.vmValidator,e.setAttribute("novalidate","novalidate"),a.validateAllInSubmit&&avalon.bind(e,"submit",function(e){e.preventDefault(),n()}),"function"==typeof a.onInit&&a.onInit.call(e,{type:"init",target:e,validator:a})},validateAll:function(e){var t=this,n="function"==typeof e?e:t.onValidateAll,a=t.fields.filter(function(e){var n=e.dom;return n&&!n.disabled&&t.dom.contains(n)}).map(function(e){return o.validate(e,!0)}),r=[];Promise.all(a).then(function(e){for(var a,o=0;a=e[o++];)r=r.concat(a);if(t.deduplicateInValidateAll){var i={};r=r.filter(function(e){var t=e.dom,n=t.uniqueID||(t.uniqueID=setTimeout("1"));return i[n]?!1:(i[n]=!0,!0)})}n.call(t.dom,r)})},addField:function(e){var t=this,n=e.dom;!t.validateInKeyup||e.isChanged||e.debounceTime||avalon.bind(n,"keyup",function(t){o.validate(e,0,t)}),t.validateInBlur&&avalon.bind(n,"blur",function(t){o.validate(e,0,t)}),t.resetInFocus&&avalon.bind(n,"focus",function(a){t.onReset.call(n,a,e)})},validate:function(e,t,n){var r=[],o=e.modelValue,i=e.dom,l=e.validator;if(!i.disabled){for(var s in e.rules){var c=e.rules[s];if(c!==!1){var u,v,f=avalon.validators[s];r.push(new Promise(function(e,t){u=e,v=t}));var d=function(t){if(e.norequired&&""===o&&(t=!0),t)u(!0);else{var n={element:i,data:e.data,message:i.getAttribute("data-"+s+"-message")||i.getAttribute("data-message")||f.message,validateRule:s,getMessage:a};u(n)}};e.data={},e.data[s]=c,f.get(o,e,d)}}var p=[],h=Promise.all(r).then(function(e){for(var a,r=0;a=e[r++];)"object"==typeof a&&p.push(a);return t||(p.length?l.onError.call(i,p,n):l.onSuccess.call(i,p,n),l.onComplete.call(i,p,n)),p});return h}}}),i=/\\?{{([^{}]+)\}}/gm;o.defaults={addField:o.addField,onError:avalon.noop,onSuccess:avalon.noop,onComplete:avalon.noop,onManual:avalon.noop,onReset:avalon.noop,onValidateAll:avalon.noop,validateInBlur:!0,validateInKeyup:!0,validateAllInSubmit:!0,resetInFocus:!0,deduplicateInValidateAll:!1}},function(e,t){function n(e){return"regexp"===avalon.type(e)}function a(e){if("string"==typeof e&&e){var t=e.split("-");if(3===t.length&&4===t[0].length){var n=~~t[0],a=~~t[1]-1,r=~~t[2],o=new Date(n,a,r);return o.getFullYear()===n&&o.getMonth()===a&&o.getDate()===r}}return!1}avalon.directive("rules",{parse:function(e,t,n){var a=n.expr;/{.+}/.test(a)&&(e[n.name]=avalon.parseExpr(n))},diff:function(e,t,n){t[n]=e[n];
}});var r=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/i,o=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/;avalon.shadowCopy(avalon.validators,{pattern:{message:"必须匹配{{pattern}}这样的格式",get:function(e,t,a){var r=t.element,o=t.data;if(!n(o.pattern)){var i=r.getAttribute("pattern");o.pattern=new RegExp("^(?:"+i+")$")}return a(o.pattern.test(e)),e}},digits:{message:"必须整数",get:function(e,t,n){return n(/^\-?\d+$/.test(e)),e}},number:{message:"必须数字",get:function(e,t,n){return n(isFinite(e)),e}},required:{message:"必须填写",get:function(e,t,n){return n(""!==e),e}},equalto:{message:"密码输入不一致",get:function(e,t,n){var a=String(t.data.equalto),r=avalon(document.getElementById(a)).val()||"";return n(e===r),e}},date:{message:"日期格式不正确",get:function(e,t,n){var r=t.data;return n("regexp"===avalon.type(r.date)?r.date.test(e):a(e)),e}},url:{message:"URL格式不正确",get:function(e,t,n){return n(o.test(e)),e}},email:{message:"email格式不正确",get:function(e,t,n){return n(r.test(e)),e}},minlength:{message:"最少输入{{minlength}}个字",get:function(e,t,n){var a=parseInt(t.data.minlength,10);return n(e.length>=a),e}},maxlength:{message:"最多输入{{maxlength}}个字",get:function(e,t,n){var a=parseInt(t.data.maxlength,10);return n(e.length<=a),e}},min:{message:"输入值不能小于{{min}}",get:function(e,t,n){var a=parseInt(t.data.min,10);return n(parseFloat(e)>=a),e}},max:{message:"输入值不能大于{{max}}",get:function(e,t,n){var a=parseInt(t.data.max,10);return n(parseFloat(e)<=a),e}},chs:{message:"必须是中文字符",get:function(e,t,n){return n(/^[\u4e00-\u9fa5]+$/.test(e)),e}}})},function(e,t,n){var a=n(37);avalon.directive("if",{priority:6,diff:function(e,t,n){var r=!!e[n];if(r||(e.nodeType=8,e.order=""),r!==t[n]){if(t[n]=r,r&&1===t.nodeType)return;a(t,this.update)}},update:function(e,t,n){var a=t["ms-if"];if(a){t.nodeType=1;var r=t.comment;n=r.parentNode,n.replaceChild(e,r),avalon.applyEffect(e,t,{hook:"onEnterDone"})}else avalon.applyEffect(e,t,{hook:"onLeaveDone",cb:function(){var a=document.createComment("ms-if");n.replaceChild(a,e),t.nodeType=8,t.comment=a}})}})},function(e,t,n){function a(e,t){var n=e.template+"<!--"+e.signature+"-->",a=$.get(n);if(!a){var r=avalon.lexer(n);avalon.speedUp(r),a=$.put(n,r)}return{action:"enter",children:avalon.mix(!0,[],a),key:t}}function r(e){var t=typeof e;return e&&"object"===t?e.$hashcode:t+":"+e}function o(e,t,n,a,o,i,l,s){var c=s?r(t):e,u={};u[o]=e,u[i]=t;for(var v in n)v in u||(u[v]=n[v]);a(e,t,c,u,l)}function i(e){for(var t in e)return!1;return!0}function l(e,t){for(var n,a=[],r=[],o=0;n=e[o++];)8===n.nodeType&&n.nodeValue===t?(r.push(n),a.push(r),r=[]):r.push(n);return a}function s(e,t){for(var n,a=t.signature,r=[],o=[],i={children:[]},l=0;n=e[l];l++)8===n.nodeType&&n.nodeValue===a?(i.children.push(n),i.key=n.key,o.push(n.key),i.index=r.length,r.push(i),i={children:[]}):i.children.push(n);return t.compareText=o.length+"|"+o.join(";;"),r}function c(e){for(var t=0,n=[];e&&(8===e.nodeType&&(0===e.nodeValue.indexOf("ms-for:")?++t:0===e.nodeValue.indexOf("ms-for-end:")&&--t),n.push(e),e=e.nextSibling,0!==t););return n}function u(e,t){var n=t.match(A);if(n){var a=n[1];for(var r in e){var o=r.match(C);if(o&&o[1]===a)return v(e,r)}}}function v(e,t){var n=e[t];if(n){var a=n.arr;if(a){var r=a.pop();return a.length||(n.arr=0),r}return delete e[t],n}}function f(e,t){var n=t.key;if(e[n]){var a=e[n],r=a.arr||(a.arr=[]);r.push(t)}else e[n]=t}var d=/ms-for\:\s*/,p=/^\s*\(\s*/,h=/\s*\)\s*$/,m=/\s*,\s*/,y=/\s+as\s+([$\w]+)/,g=n(48).ident,_=n(37),b=/^(null|undefined|NaN|window|this|\$index|\$id)$/,w=n(52),x=n(28),$=new x(100),T=/^\s*function\s*\(([^\)]+)\)/;avalon._each=function(e,t,n,a){var r=[];a.push(r);var i=(t+"").match(T),l=i[1],s=l.match(avalon.rword);if(Array.isArray(e))for(var c=0;c<e.length;c++)o(c,e[c],n,t,s[0],s[1],r,!0);else for(var c in e)e.hasOwnProperty(c)&&o(c,e[c],n,t,s[0],s[1],r)},avalon.directive("for",{priority:3,parse:function(e,t,n){var a,r=t.nodeValue;r=r.replace(y,function(e,t){return!g.test(t)||b.test(t)?avalon.error("alias "+t+" is invalid --- must be a valid JS identifier which is not a reserved name."):a=t,""});var o=r.replace(d,"").split(" in "),i="var loop = "+avalon.parseExpr(o[1])+" \n",l=a?"var "+a+" = loop\n":"",s=o[0].replace(p,"").replace(h,"").split(m);1===s.length&&s.unshift("$key"),s.push("traceKey"),s.push("__local__"),s.push("vnodes"),t.$append=i+l+"avalon._each(loop,function("+s.join(", ")+"){\n"+(a?"__local__["+avalon.quote(a)+"]=loop\n":"")},diff:function(e,t,n,r,o){function l(e,t){var n=e.template+"<!--"+e.signature+"-->",a=avalon.lexer(n);return avalon.speedUp(a),{action:"enter",children:a,key:t}}r=r||[],t.preRepeat=r;var c=s(n,e);if(t.compareText!==e.compareText){t.preItems||(t.preItems=s(r,t)),t.compareText=e.compareText;var d,p,h,m=t.cache;if(avalon.msie<=8&&(a=l),!m||i(m)){var m=t.cache={};for(t.preItems.length=0,d=0;p=c[d];d++){var h=a(t,p.key);t.preItems.push(h),h.action="enter",h.index=d,f(m,h)}t.removes=[]}else{var y={},g=[];for(d=0;p=c[d++];){var h=v(m,p.key);h?(h.action="move",h.oldIndex=h.index,h.index=p.index,f(y,h)):g.push(p)}for(var p,d=0;p=g[d++];)h=u(m,p.key),h?(h.action="move",h.oldIndex=h.index,h.index=p.index):(h=a(t,p.key),h.index=p.index,t.preItems.push(h)),f(y,h);t.preItems.sort(function(e,t){return e.index-t.index}),t.cache=y;var b=[];for(var d in m)h=m[d],h.action="leave",b.push(h),h.arr&&(h.arr.forEach(function(e){e.action="leave",b.push(e)}),delete h.arr);t.removes=b}var w=avalon.caches[t.cid],x=e.vmodel;return o&&w&&(o.afterChange=[function(e){w.call(x,{type:"rendered",target:e,signature:t.signature})}]),_(t,this.update),!0}},update:function(e,t,n){var a=t.signature,r=c(e),o=r.slice(1,-1),i=r.pop(),s=l(o,a),u=o[o.length-1];if(u&&u.nodeValue!==a)for(;;){var v=i.previousSibling;if(v===e||v.nodeValue===a)break;if(!v)break;n.removeChild(v)}for(var f,d=0;f=t.removes[d++];){var p=s[f.index];p&&(p.forEach(function(e,t){e.parentNode&&avalon.applyEffect(e,f.children[t],{hook:"onLeaveDone",cb:function(){e.parentNode.removeChild(e)},staggerKey:a+"leave"})}),f.children.length=0)}t.removes=[];for(var h,m=e,y=avalon.avalonFragment,g=[],d=0;d<t.preItems.length;d++){var _=t.preItems[d],b=_.children;if("leave"!==_.action){if(g.push(_),"enter"===_.action){h||(h=avalon.vdomAdaptor(b,"toDOM"));var x=h.cloneNode(!0),$=avalon.slice(x.childNodes);w($,b,n),n.insertBefore(x,m.nextSibling),k($,b,{hook:"onEnterDone",staggerKey:a+"enter"})}else if("move"===_.action){var $=s[_.oldIndex]||[];if(_.index!==_.oldIndex){for(var T,A=y.cloneNode(!1),C=0;T=$[C++];)A.appendChild(T);n.insertBefore(A,m.nextSibling),k($,b,{hook:"onMoveDone",staggerKey:a+"move"})}}if(m=$[$.length-1],!m)break}}t.preRepeat.length=0,t.preItems.length=0,g.forEach(function(e){t.preItems.push(e),r.push.apply(t.preRepeat,e.children)})}});var A=/^(string|number|boolean)/,C=/^_*(string|number|boolean)/,k=function(e,t,n){t.forEach(function(a,r){avalon.applyEffect(e[r],t[r],n)})}},function(e,t,n){function a(e,t){e.children=[],avalon.mix(e,t),e.local=e.isVoidTag=e.skipContent=0}function r(e,t){var n=t.is,a=t[n+"-vm"],r=t[n+"-html"],o=avalon.vdomAdaptor(t,"toHTML");r!==o&&(t[n+"-html"]=o,a.$fire("onViewChange",{type:"viewchange",target:e,vmodel:a,is:n}))}function o(e){var t=!0;try{i(e)}catch(n){t=!1}return t}function i(e){e.children.forEach(function(e){if(8===e.nodeType){if("unresolved component placeholder"===e.nodeValue)throw"unresolved"}else e.children&&i(e)})}var l=n(37),s=n(52),c=n(67);avalon.component=function(e,t){avalon.components[e]||(avalon.components[e]=t)},avalon.directive("widget",{parse:function(e,t,n){t.wid=t.wid||avalon.makeHashCode("w"),e[n.name]=avalon.parseExpr(n),e.vmodel="__vmodel__",e.local="__local__"},define:function(){return avalon.mediatorFactory.apply(this,arguments)},diff:function(e,t,n){var r=e[n];t[n];if(t.vmodel=e.vmodel,t.local=e.local,t.copy=e,Object(r)===r){r=r.$model||r,Array.isArray(r)&&(r=avalon.mix.apply({},r));var i=r.is||t.props.is;if(!t[i+"-vm"]&&!c(t,e,i))return void l(t,this.mountComment);var s=t[i+"-vm"].$render,u=s(t[i+"-vm"],t.local),v=u[0];v&&o(v)?t[i+"-mount"]?(a(e,v),l(t,this.updateComponent)):(t.copy=e,t.newCopy=v,l(t,this.mountComponent)):l(t,this.mountComment)}},mountComment:function(e,t,n){var a=t.copy;a.nodeType=t.nodeType=8,a.nodeValue=t.nodeType="unresolved component placeholder",a.children=[];var r=document.createComment(a.nodeValue);t.dom=r,n.replaceChild(r,e)},updateComponent:function(e,t){var n=t.is,a=t[n+"-vm"],o=a.$events.onViewChange;o&&o.length&&l(t,r,"afterChange")},mountComponent:function(e,t,n){var r=t.is,o=t[r+"-vm"],i=t.copy,c=t.newCopy;delete t.newCopy;var u=avalon.scopes[o.$id];if(u&&u.vmodel){var v=u.vmodel.$element;return c=v.vtree[0],a(t,c),n.replaceChild(v,e),v.vtree=[t],t[r+"-vm"]=u.vmodel,void(t[r+"-mount"]=!0)}a(i,c);var f=t[r+"-vtree"];a(t,f[0]);var v=avalon.vdomAdaptor(t,"toDOM");o.$fire("onInit",{type:"init",vmodel:o,is:r}),s([v],[t]),n.replaceChild(v,e),t.dom=v,avalon.onComponentDispose(v),t[r+"-mount"]=!0,o.$element=v,v.vtree=[t],avalon.scopes[o.$id]={vmodel:o,isMount:2,local:t.local},l(t,function(){o.$fire("onReady",{type:"ready",target:v,vmodel:o,is:r})},"afterChange"),l(t,function(){t[r+"-html"]=avalon.vdomAdaptor(t,"toHTML")},"afterChange")}})},function(e,t,n){function a(e,t,n){var a=e.type;if(!v[a]&&!s(a))return void avalon.warn(a+"不合适做组件的标签");var f={},h=t["ms-widget"],m=!1;if(h){var y=[].concat(h);y.forEach(function(e){e&&"object"==typeof e&&c(f,e.$model||e,!0)}),m=o(f)}else m=!0,y=[];var g=avalon.components[n];if(g){var _=p.concat(),b=n.replace(/-/g,"_"),w=t.vmodel;try{var x=w[b];m&&x&&"object"==typeof x&&(f={},y=[x],c(f,x.$model||x,!0),_.push(b))}catch($){}v[a]&&e.children[0]&&(e.children=avalon.lexer(e.children[0].nodeValue)),e.isVoidTag=e.skipContent=0;var T=f.define;T=T||avalon.directives.widget.define,f.$id||avalon.warn("warning!",n,"组件没有在ms-widget配置对象中指定全局不重复的$id\n","若在ms-for循环中可以利用 ($index,el) in @array 中的$index拼写你的$id\n","如 ms-widget=\"{is:'ms-button',$id:'btn'+$index}\"");var A=f.$id||e.wid,C=avalon.mix(!0,{},g.defaults);c(f,C,!1);var k=T.apply(function(e,t){_.forEach(function(n){delete e[n],delete t[n]})},[w,C].concat(y));if(!avalon.modern)for(var E in k)u[E]||"function"!=typeof k[E]||(k[E]=k[E].bind(k));k.$id=A;var O=g.template.trim();"function"==typeof g.getTemplate&&(O=g.getTemplate(k,O));var M=avalon.lexer(O);M.length>1&&avalon.error("组件必须用一个元素包起来");var S=M[0];if(avalon.vmodels[A]=k,avalon.mix(S.props,e.props),delete S.props["ms-widget"],S.props.wid=A,g.soleSlot){var j={},V=g.soleSlot;j[V]=/\S/.test(e.template)?e.children:r(V),l(M,j)}else e.isVoidTag||i(M,e,g.soleSlot);avalon.speedUp(M);for(var $ in d)f[$]&&f[$].forEach(function(e){k.$watch($,e)});var D=avalon.render(M,e.local);return k.$render=D,e[n+"-vm"]=k,e[n+"-vtree"]=M,e.is=n}}function r(e){return{nodeType:3,nodeValue:"{{##"+e+"}}",type:"#text",dynamic:!0}}function o(e){for(var t in e)if("is"!==t&&"$id"!==t)return!1;return!0}function i(e,t,n){var a={};n?a[n]=t.children:t.children.forEach(function(e){if(1===e.nodeType){var t=e.props.slot||"default";a[t]?a[t].push(e):a[t]=[e]}}),l(e,a)}function l(e,t){for(var n,a=0;n=e[a++];)if(1===n.nodeType)if("slot"===n.type){var o=n.props.name||"default";if(t[o]){var i=t[o].length?t[o]:r(o);e.splice.apply(e,[a-1,1].concat(i))}}else l(n.children,t);return e}function s(e){return h.test(e)}function c(e,t,n){for(var a in t){var r=t[a];d[a]?a in e?e[a].push(r):e[a]=[t[a]]:n&&(e[a]=r)}}var u=n(68),v={wbr:1,xmp:1,template:1},f="onInit,onReady,onViewChange,onDispose",d=avalon.oneObject(f),p=f.split(",").concat("is","define");e.exports=a;var h=/^[a-z]([a-z\d]+\-)+[a-z\d]+$/},function(e,t){e.exports=avalon.oneObject("$id,$render,$track,$element,$watch,$fire,$events,$model,$skipArray,$accessors,$hashcode,$run,$wait,__proxy__,__data__,__const__")},function(e,t,n){function a(e,t){for(var n in e)if(e[n]!==t[n])return!0;return!1}function r(){if(!f.lock){var e=f[0];e&&(r.lock=!0,e())}}function o(e){var t=p.test(e)?1e3:1;return parseFloat(e)*t}function i(e,t,n){var a=e[t];a=Array.isArray(a)?a:"function"==typeof a?[a]:[],a.forEach(function(e){e&&e(n)})}function l(e){var t=e.toLowerCase();return function(n){var a,l=this.el,s=avalon(l),u=isFinite(n.stagger)?1e3*n.stagger:0;if(u&&n.staggerKey){var v=h.get(n.staggerKey)||h.put(n.staggerKey,{count:0,items:0});v.count++,v.items++}var d=v&&v.count||0,p=function(t){var o=t!==!1;l.animating=void 0,a=!0;var s=o?"Done":"Abort";i(n,"on"+e+s,l),avalon.unbind(l,c.transitionEndEvent),avalon.unbind(l,c.animationEndEvent),v&&0===--v.items&&(v.count=0),n.queue&&(f.lock=!1,f.shift(),r())};i(n,"onBefore"+e,l),n[t]?n[t](l,function(e){p(e!==!1)}):c.css&&(s.addClass(n[t+"Class"]),"leave"===t?s.removeClass(n.enterClass+" "+n.enterActiveClass):"enter"===t&&s.removeClass(n.leaveClass+" "+n.leaveActiveClass),s.bind(c.transitionEndEvent,p),s.bind(c.animationEndEvent,p),setTimeout(function(){a=NaN===avalon.root.offsetWidth,s.addClass(n[t+"ActiveClass"]);var e=window.getComputedStyle(l),r=e[c.transitionDuration],i=e[c.animationDuration],v=o(r)||o(i);0===!v?p(!1):u||setTimeout(function(){a||p(!1)},v+130)},17+u*d))}}function s(e){e.acton||(e.action=e.hook.replace(/^on/,"").replace(/Done$/,"").toLowerCase())}var c=n(70),u=n(28),v=n(37);avalon.directive("effect",{priority:5,diff:function(e,t,n){var r=e[n];if(r=e.$model||r,"string"==typeof r){var o=r;r={is:o}}else Array.isArray(r)&&(r=avalon.mix.apply({},r));if(r.action=r.action||"enter",Object(r)===r){var i=t[n];(Object(i)!==i||a(r,i))&&(t[n]=r,v(t,this.update,"afterChange"))}delete e[n]},update:function(e,t,n,a){if(!e.animating){e.animating=!0;var o=t["ms-effect"],i=o.is;if(a=a||{},!i)return avalon.warn("need is option");var l=avalon.effects;c.css&&!l[i]&&avalon.effect(i,{});var s=l[i];if(!s)return avalon.warn(i+" effect is undefined");var u=a.action||o.action,v=avalon.Effect;if("function"!=typeof v.prototype[u])return avalon.warn(u+" action is undefined");var d=new v(e),p=avalon.mix(a,s,o);p.queue?(f.push(function(){d[u](p)}),r()):setTimeout(function(){d[u](p)},4)}}});var f=[];avalon.effects={},avalon.effect=function(e,t){avalon.effects[e]=t||{},c.css&&(t.enterClass||(t.enterClass=e+"-enter"),t.enterActiveClass||(t.enterActiveClass=t.enterClass+"-active"),t.leaveClass||(t.leaveClass=e+"-leave"),t.leaveActiveClass||(t.leaveActiveClass=t.leaveClass+"-active")),t.action||(t.action="enter")};var d=function(e){this.el=e};avalon.Effect=d,d.prototype={enter:l("Enter"),leave:l("Leave"),move:l("Move")};var p=/\d+s$/,h=new u(128);avalon.applyEffect=function(e,t,n){var a=n.cb,r=n.hook,o=t["ms-effect"];if(o&&!avalon.document.hidden){var i=o[r];a&&(Array.isArray(i)?i.push(a):i?o[r]=[i,a]:o[r]=[a]),s(n),e.animate=!0,avalon.directives.effect.update(e,t,0,avalon.shadowCopy({},n))}else a&&a()}},function(e,t){var n,a,r,o=!1,i=!1,l=!1,s=avalon.cssName("transition-duration"),c=avalon.cssName("animation-duration"),u={TransitionEvent:"transitionend",WebKitTransitionEvent:"webkitTransitionEnd",OTransitionEvent:"oTransitionEnd",otransitionEvent:"otransitionEnd"},v=avalon.window;for(var f in u){if(v[f]){r=u[f];break}try{document.createEvent(f);r=u[f];break}catch(d){}}"string"==typeof r&&(o=!0,l=!0,n=r),u={AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"};var p;for(f in u)if(v[f]){p=u[f];break}"string"==typeof p&&(i=!0,l=!0,a=p),e.exports={transition:o,animation:i,css:l,transitionEndEvent:n,animationEndEvent:a,transitionDuration:s,animationDuration:c}},function(e,t,n){function a(e,t){var n=Array.isArray(e)?r(e):e,a=[];if(t)for(var o in t)a.push("var "+o+" = __local__["+avalon.quote(o)+"]");var i="__local__ = __local__ || {};\n"+a.join(";\n")+"\n"+n,l=Function("__vmodel__","__local__",i);return l}avalon.lexer=n(72),avalon.diff=n(73),avalon.batch=n(74);var r=n(45);avalon.render=a,e.exports=avalon},function(e,t,n){function a(e){var t="??"+S++;return M[t]=e,t}function r(e){var t=M[e];return t}function o(e){return j.test(e)?e.replace(V,"").replace(E,a):e}function i(e,t){var n=[];for("number"!=typeof t&&(t=0),t||(e=e.replace(E,a));;){var i="",u=!1,f=e.match(w);if(f&&(i=f[0],u={type:"#text",nodeType:3,nodeValue:i.replace(k,r)}),u||(f=e.match(x),f&&(i=f[0],u={type:"#comment",nodeType:8,nodeValue:f[1].replace(k,r)})),!u&&(f=e.match(_))){i=f[0];var d=f[1].toLowerCase();i=s(i,d),f=i.match(b);var p={};f[2]&&v(o(f[2]),p);var h=i.slice(f[0].length,-1*(d.length+3));u={nodeType:1,type:d,props:p,children:[]},u=c(u,n,t,h,h.replace(k,r).trim())}if(u||(f=e.match(b),f&&(i=f[0],d=f[1].toLowerCase(),p={},f[2]&&v(o(f[2]),p),u={nodeType:1,type:d,props:p,children:[],isVoidTag:!0},u=c(u,n,t,"",""))),!u)break;(3!==u.nodeType||/\S/.test(u.nodeValue))&&n.push(u),e=e.slice(i.length),8===u.nodeType&&(T.test(u.nodeValue)?(u.signature=u.signature||m("for"),u.dynamic="for"):A.test(u.nodeValue)&&(n.pop(),l(n,u)))}return t||(M={}),n}function l(e,t){for(var n,a=[],r=1;n=e.pop();){if(8===n.nodeType)if(A.test(n.nodeValue))++r;else if(T.test(n.nodeValue)&&(--r,0===r)){t.signature=n.signature,e.push(n,a,t),n.template=a.map(function(e){return avalon.vdomAdaptor(e,"toHTML")}).join("");break}a.unshift(n)}}function s(e,t){var n=[],a=[],r=N[t+"open"]||(N[t+"open"]=new RegExp("<"+t+D,F)),o=N[t+"close"]||(N[t+"close"]=new RegExp("</"+t+">",F));e.replace(r,function(e,t){return n.push(("0000000000"+t+"<").slice(-10)),e.replace(L,"1")}).replace(o,function(e,t){a.push(("0000000000"+t+">").slice(-10))});for(var i=n.concat(a).sort(),l=i.join("").replace($,""),s=0,c=0,u=0,v=l.length;v>u;u++){var f=l.charAt(u);if("<"===f?s+=1:s-=1,0===s){c=u;break}}var d=parseFloat(i[c])+t.length+3;return e.slice(0,d)}function c(e,t,n,a,r){var o=e.type,l=e.props;switch(o){case"style":case"script":case"noscript":case"template":case"textarea":case"xmp":e.skipContent=!0,r?e.children.push(new g(r)):e.children=[],"textarea"===o&&(l.type="textarea",e.children.length=0);break;case"input":l.type||(l.type="text");break;case"select":l.hasOwnProperty("multiple")&&(l.multiple="multiple",e.multiple=!0);break;case"option":e.children.push(new g(f(r)));break;default:/^ms-/.test(o)&&(l.is=o,l["ms-widget"]||(l["ms-widget"]="{is:"+avalon.quote(o)+"}"))}if(!e.isVoidTag&&!e.skipContent){var s=i(a,n+1);e.children=s,"table"===o&&u(e.children)}var c=l["ms-for"];if(c){var v=l["data-for-rendered"],d=v+":cb";return delete l["ms-for"],t.push({nodeType:8,type:"#comment",nodeValue:"ms-for:"+c,signature:m("for"),dynamic:"for",cid:d}),v&&!avalon.caches[d]&&(avalon.caches[d]=Function("return "+avalon.parseExpr(v,"on"))()),t.push(e),{nodeType:8,type:"#comment",dynamic:!0,nodeValue:"ms-for-end:"}}return e}function u(e){for(var t,n=!1,a=0,r=0,o=e.length,i=0;o>i;i++){var l=e[i];t?"tr"!==l.type&&1===l.nodeType?t=!1:(t.children.push(l),a++,e[i]=0):"tr"===l.type&&(t={nodeType:1,type:"tbody",children:[],props:{}},t.children.push(l),n=!0,0===r&&(r=i),e[i]=t)}if(n)for(i=r;o>i&&(0!==e[i]||(e.splice(i,1),i--,a--,0!==a));i++);}function v(e,t){e.replace(H,"=").replace(P,function(e){var n=e.split("="),a=n[1]||"",o=n[0].toLowerCase();2===n.length&&0===a.indexOf("??")&&(a=a.replace(k,r).slice(1,-1)),t[o]=a})}function f(e){return String(e).replace(I,"").trim()}function d(e){switch(e.nodeType){case 3:return O.rbind.test(e.nodeValue)?(e.dynamic="expr",!0):(e.skipContent=!0,!1);case 8:return e.dynamic?!0:(e.skipContent=!0,!1);case 1:if(e.props["ms-skip"])return e.skipAttrs=!0,e.skipContent=!0,!1;if(/^ms\-/.test(e.type)&&(e.dynamic=!0),h(e.props)?e.dynamic=!0:e.skipAttrs=!0,e.isVoidTag&&!e.dynamic)return e.skipContent=!0,!1;var t=p(e.children);return t||e.dynamic?!0:(e.skipContent=!0,!1);default:if(Array.isArray(e))return p(e)}}function p(e){for(var t,n=!1,a=0;t=e[a++];)d(t)&&(n=!0);return n}function h(e){if("ms-skip"in e)return!1;for(var t in e)if(0===t.indexOf("ms-"))return!0;return!1}var m=avalon.makeHashCode,y=n(15),g=y.VText,_=(y.VComment,/^<([-A-Za-z0-9_]+)(?:\s+[^=\s]+(?:=[^>\s]+)?)*\s*>(?:[\s\S]*)<\/\1>/),b=/^<([-A-Za-z0-9_]+)\s*([^>]*?)\/?>/,w=/^[^<]+/,x=/^<!--([\w\W]*?)-->/,$=/\d+/g,T=/^\s*ms\-for\:/,A=/^\s*ms\-for\-end/,C=n(48),k=(C.sp,/\?\?\d+/g),E=(C.leftSp,C.string),O=avalon.config,M={},S=1,j=/=["']/,V=/\n\s*/g,D="(?:\\s+[^>=]*?(?:=[^>]+?)?)*>",N={},L=/./g,F=avalon.msie<9?"ig":"g",P=/\S+/g,H=/\s*=\s*/g,I=/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi;e.exports=i,avalon.speedUp=function(e){for(var t=0;t<e.length;t++)d(e[t])}},function(e,t,n){function a(e,t){for(var n=0;n<e.length;n++){var c=e[n],u=t[n]||l();switch(c.nodeType){case 3:c.dynamic&&s.expr.diff(c,u);break;case 8:"for"===c.dynamic&&s["for"].diff(c,u,e[n+1],t[n+1],t[n+2]),u.afterChange&&r(u,u.afterChange);break;case 1:c.order&&o(c,u),c.skipContent||c.isVoidTag||a(c.children,u.children||i,c),u.afterChange&&r(u,u.afterChange);break;default:Array.isArray(c)&&a(c,u)}}}function r(e,t){if(t.length)for(var n,a=0;n=t[a++];)n(e.dom,e);delete e.afterChange}function o(e,t){var n=e.order;if(n){var a;try{n.replace(avalon.rword,function(r){var o=r.match(c),i=o&&o[1];if(a=i,s[i]&&s[i].diff(e,t||l(),r),e.order!==n)throw"break"})}catch(r){"break"!==r?avalon.log(a,r,r.stack||r.message,"diffProps error"):o(e,t)}}}var i=[],l=function(){return{children:[],props:{}}},s=avalon.directives,c=n(48).binding;avalon.diffProps=o,e.exports=a},function(e,t,n){function a(e){if(i)return avalon.Array.ensure(o,e);i=e;var t=avalon.scopes[e];if(!t||!document.nodeName||avalon.suspendUpdate)return i=null;var n=t.vmodel,l=n.$element,s=l.vtree||[],c=n.$render,u=c(t.vmodel,t.local);if(t.isMount||(r([l],s,l.parentNode),t.isMount=1),avalon.diff(u,s),1===t.isMount){var v=n.$events.onReady;v&&(n.$fire("onReady"),delete n.$events.onReady),t.isMount=2}var f=o.indexOf(i);if(i=0,f>-1){var d=o.splice(f,1);return a(d[0])}var p=o.shift();p&&a(p)}var r=n(52),o=[],i=!1;avalon.suspendUpdate=0,e.exports=avalon.batch=a},function(e,t){function n(e){e.addEventListener("DOMNodeRemovedFromDocument",function(){l(e)})}function a(){function e(e,t){var a=n[e];n[e]=function(e,n){return t.call(this,a,e,n)}}function t(e){var t=avalon.slice(this.getElementsByTagName("*"));r.call(this,e),s(t)}if(!a.execute){a.execute=!0;var n=Node.prototype;e("removeChild",function(e,t,n){return e.call(this,t,n),1===t.nodeType&&l(t),t}),e("replaceChild",function(e,t,n){return e.call(this,t,n),1===t.nodeType&&l(t),t});var r,o=Element.prototype;if(Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(o,"innerHTML");r=i.set,i.set=t,Object.defineProperty(o,"innerHTML",i)}else r=o.__lookupSetter__("innerHTML"),o.__defineSetter__("innerHTML",t);e("appendChild",function(e,t){return e.call(this,t),1===t.nodeType&&11===this.nodeType&&l(t),t}),e("insertBefore",function(e,t,n){return e.call(this,t,n),1===t.nodeType&&11===this.nodeType&&l(t),t})}}function r(e){avalon.Array.ensure(c,e),u||(u=setInterval(function(){for(var e,t=0;e=c[t];)!1===i(e)?avalon.Array.removeAt(c,t):t++;0==c.length&&(clearInterval(u),u=0)},700))}function o(e){for(;e;){if(9===e.nodeType)return!0;e=e.parentNode}return!1}function i(e){if(1===e.nodeType&&e.getAttribute("wid")&&!o(e)){var t=e.getAttribute("wid"),n=avalon.scopes[t];if(!n)return;var a=n.vmodel;return n.vmodel.$fire("onDispose",{type:"dispose",target:e,vmodel:a}),n&&!e.getAttribute("cached")&&(a.$element=null,a.$hashcode=!1,e.vtree=void 0,delete n.vmodel,delete avalon.scopes[t]),!1}}function l(e){setTimeout(function(){i(e)},4)}function s(e){for(var t,n=0;t=e[n++];)i(t)}var c=[],u=0;e.exports=function(e){window.chrome&&window.MutationEvent?n(e):avalon.modern&&"function"==typeof window.Node?a(e):r(e)}},function(e,t,n){function a(){}function r(e,t,n){var r={};e.$skipArray&&(r=avalon.oneObject(e.$skipArray),delete e.$skipArray);var o={};n=n||{},t=t||{};var i={},l=g("$"),s=n.pathname||"";n.id=n.id||l,n.hashcode=n.hashcode||l;var v,f,y;for(v in e)if(!d[v]){var _=o[v]=e[v];u(v,_,r)||(f=n.id+"."+v,y=s?s+"."+v:v,i[v]=p(f,y,t))}i.$model=m;var b=new a;b=c(b,i,e);for(v in o)b[v]=o[v],v in r?delete o[v]:o[v]=!0;return h(b,t,o,i,n),b}function o(e,t,n,r){var o={},i={},l={};n=n||{};var s,v,f,y=r.pathname,b=e.$accessors||{};for(s in t)d[s]||(o[s]=!0,u(s,t[s],_)?(i[s]=t[s],delete t[s]):b[s]?l[s]=b[s]:(v=r.id+"."+s,f=y?y+"."+s:s,l[s]=p(v,f,n)));r.hashcode=e.$hashcode||g("$"),l.$model=m;var w=new a;w=c(w,l,i);for(s in i)w[s]=i[s];return h(w,n,o,l,r),w}function i(e,t){for(var n,r={},o={},i={},l={},s=avalon.slice(arguments),v={},f=0;f<s.length;f++){var m,y,_=s[f];for(var n in _)if(_.hasOwnProperty(n)){"$skipArray"===n&&Array.isArray(_.$skipArray)&&_.$skipArray.forEach(function(e){v[e]=1}),r[n]=_[n];var b=_.$accessors;b&&b[n]?-1===s.indexOf(_[n])?o[n]=b[n]:(m=r[n],y=n,delete r[n]):"function"!=typeof r[n]&&(i[n]=1)}}"function"==typeof this&&this(r,i);for(n in i)d[n]||o[n]||u(n,r[n],v)||(o[n]=p(e.$id,n,l),o[n].set(r[n]));var w=new a;w=c(w,o,r);for(n in r){if(o[n]||(w[n]=r[n]),y&&o[n]&&m.hasOwnProperty(n)){var x=o[n];x.get.$decompose||(x.get.$decompose={}),x.get.$decompose[y+"."+n]=w}n in d?delete r[n]:r[n]=!0}return h(w,l,r,o,{id:e.$id,hashcode:g("$"),master:!0}),w}function l(e,t){e.length!==t&&e.notify("length",e.length,t,!0)}var s=n(77),c=n(81),u=s.isSkip,v=s.toJson,f=s.$$midway,d=s.$$skipArray,p=s.makeAccessor,h=s.initViewModel,m=s.modelAccessor,y=s.modelAdaptor,g=avalon.makeHashCode;f.masterFactory=r;var _={};f.slaveFactory=o,f.mediatorFactory=avalon.mediatorFactory=i;var b=s.__array__,w=Array.prototype,x=w.splice;b.removeAll=function(e){var t=this.length;if(Array.isArray(e))for(var n=this.length-1;n>=0;n--)-1!==e.indexOf(this[n])&&x.call(this,n,1);else if("function"==typeof e)for(n=this.length-1;n>=0;n--){var a=this[n];e(a,n)&&x.call(this,n,1)}else x.call(this,0,this.length);avalon.modern||(this.$model=v(this)),l(this,t),this.notify()};var $=["push","pop","shift","unshift","splice"];$.forEach(function(e){var t=w[e];b[e]=function(n,a){var r=[],o=this.length;if("splice"===e&&Object(this[0])===this[0])for(var i=this.slice(n,a),s=w.slice.call(arguments,2),r=[n,a],c=0,u=s.length;u>c;c++){var f=i[c];r[c+2]=y(s[c],f,f&&f.$events||{},{id:this.$id+".*",master:!0})}else for(var d=0,p=arguments.length;p>d;d++)r[d]=y(arguments[d],0,{},{id:this.$id+".*",master:!0});var h=t.apply(this,r);return avalon.modern||(this.$model=v(this)),l(this,o),this.notify(),h}}),"sort,reverse".replace(avalon.rword,function(e){b[e]=function(){return w[e].apply(this,arguments),avalon.modern||(this.$model=v(this)),this.notify(),this}}),e.exports=avalon},function(e,t,n){function a(e){var t=avalon.type(e);if("array"===t){for(var n=[],r=0;r<e.length;r++)n[r]=a(e[r]);return n}if("object"===t){var o={};for(r in e)if("__proxy__"!==r&&"__data__"!==r&&"__const__"!==r&&e.hasOwnProperty(r)){var i=e[r];o[r]=i&&i.nodeType?i:a(i)}return o}return e}function r(e,t,n){c?Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!1,configurable:!0}):e[t]=n}function o(e,t,n,o,s){function c(e){return n[e]===!0}s.array?avalon.modern?Object.defineProperty(e,"$model",v):e.$model=a(e):(r(e,"$accessors",o),r(e,"hasOwnProperty",c),r(e,"$track",Object.keys(n).sort().join(";;"))),r(e,"$id",s.id),r(e,"$hashcode",s.hashcode),s.master===!0&&(r(e,"$run",function(){l.call(e)}),r(e,"$wait",function(){i.call(e)}),r(e,"$element",null),r(e,"$render",0),u(e,t))}function i(){this.$events.$$wait$$=!0}function l(){var e=this.$events;if(delete e.$$wait$$,e.$$dirty$$){delete e.$$dirty$$,avalon.rerenderStart=new Date;var t=this.$id,n=t.indexOf(".");n>0?avalon.batch(t.slice(0,n)):avalon.batch(t)}}var s=n(78),c=n(80),u=s.initEvents,v={get:function(){return a(this)},set:avalon.noop,enumerable:!1,configurable:!0};s.$$midway.initViewModel=o,s.$$midway.hideProperty=r;var f={toJson:a,initViewModel:o,modelAccessor:v};for(var d in s)f[d]=s[d];e.exports=f},function(e,t,n){function a(e,t){t.__vmodel__=e;var n=d.hideProperty;n(e,"$events",t),n(e,"$watch",function(){if(2===arguments.length)return y.apply(e,arguments);throw"$watch方法参数不对"}),n(e,"$fire",function(t,n,a){var r=e.$events[t];m(r,e,t,n,a)})}function r(e,t,n){return"$"===e.charAt(0)||n[e]||g.test(avalon.type(t))||t&&t.nodeName&&t.nodeType>0}function o(e,t,n,a){if(Array.isArray(e))return d.arrayFactory(e,t,n,a);if(Object(e)===e&&"function"!=typeof e){if(t&&t.$id){if(++avalon.suspendUpdate,t.$track!==Object.keys(e).sort().join(";;"))var r=d.slaveFactory(t,e,n,a);else r=t;for(var o in e)p[o]||(r[o]=e[o]);return--avalon.suspendUpdate,r}return r=d.masterFactory(e,n,a)}return e}function i(e,t,n){function a(){return r}var r=NaN;return a.heirloom=n,{get:a,set:function(o){if(r!==o){var i=n.__vmodel__;o&&"object"==typeof o&&(o=d.modelAdaptor(o,r,n,{pathname:t,id:e}));var v=r;if(r=o,this.$hashcode&&i){if(i.$events.$$dirty$$=!0,i.$events.$$wait$$)return;n!==i.$events&&(a.heirloom=i.$events),c(a.$decompose,t,o,v),-1===t.indexOf("*")&&m(a.heirloom[t],i,t,o,v),s(e,i,t,o,v),u(a.heirloom,i,t,o,v),i.$events.$$dirty$$=!1,l(i.$id)}}},enumerable:!0,configurable:!0}}function l(e){avalon.rerenderStart=new Date;var t=e.indexOf(".");t>0?avalon.batch(e.slice(0,t)):avalon.batch(e)}function s(e,t,n,a,r){if(e.indexOf(".*.")>0){var o=e.match(_),i=avalon.vmodels[o[1]];if(i){var l=o[2];m(i.$events[l],t,n,a,r)}}}function c(e,t,n,a){if(e&&e[t]){var r=e[t];if(r.$hashcode){var o=t.replace(/^[^.]+\./,"");o!==t&&m(r.$events[o],r,o,n,a)}else delete e[t]}}function u(e,t,n,a,r){e.__fuzzy__&&e.__fuzzy__.replace(avalon.rword,function(o){var i=e[o],l=i.reg;return l&&l.test(n)&&m(i,t,n,a,r),o})}function v(e){var t=e.$id;if(!t&&avalon.config.debug&&avalon.warn("vm.$id must be specified"),avalon.vmodels[t])throw Error("error:["+t+"] had defined!");var n=d.masterFactory(e,{},{pathname:"",id:t,master:!0});return avalon.vmodels[t]=n}function f(e,t,n,a){if(t&&t.splice){var r=[0,t.length].concat(e);return++avalon.suspendUpdate,t.splice.apply(t,r),--avalon.suspendUpdate,t}for(var i in b)e[i]=b[i];e.notify=function(e,t,r,o){var i=n.__vmodel__;if(i){var s=null===e||void 0===e?a.pathname:a.pathname+"."+e;i.$fire(s,t,r),o||n.$$wait$$||avalon.suspendUpdate||l(i.$id)}};var s=avalon.makeHashCode("$");a.array=!0,a.hashcode=s,a.id=a.id||s,d.initViewModel(e,n,{},{},a);for(var c=0,u=e.length;u>c;c++)e[c]=o(e[c],0,{},{id:e.$id+".*",master:!0});return e}var d={},p=n(68),h=n(79),m=h.$emit,y=h.$watch,g=/function|window|date|regexp|element/i;d.modelAdaptor=o;var _=/([^.]+)\.(.+)/;d.arrayFactory=f;var b={set:function(e,t){if(e>>>0===e&&this[e]!==t){if(e>this.length)throw Error(e+"set方法的第一个参数不能大于原数组长度");this.splice(e,1,t)}},contains:function(e){return-1!==this.indexOf(e)},ensure:function(e){return this.contains(e)||this.push(e),this},pushArray:function(e){return this.push.apply(this,e)},remove:function(e){return this.removeAt(this.indexOf(e))},removeAt:function(e){return e>>>0===e?this.splice(e,1):[]},clear:function(){return this.removeAll(),this}};avalon.define=v,e.exports={$$midway:d,$$skipArray:p,isSkip:r,__array__:b,initEvents:a,makeAccessor:i,modelAdaptor:o}},function(e,t){function n(e,t){var n,a=t.split(".")[0];try{e.hasOwnProperty(a)&&(n=e.$accessors?e.$accessors[a].get.heirloom.__vmodel__:Object.getOwnPropertyDescriptor(e,a).get.heirloom.__vmodel__)}catch(r){}return n||e}function a(e){var t=e.split(".");return new RegExp("^"+t.map(function(e){return"*"===e?"(?:[^.]+)":e}).join("\\.")+"$","i")}function r(e,t,n){e&&(t.__fuzzy__?-1===t.__fuzzy__.indexOf(","+n)&&(t.__fuzzy__+=","+n):t.__fuzzy__=n)}function o(e,t){var n=e.indexOf(".*")>0||"*"===e,i=n?this:o.adjust(this,e),l=i.$events,s=l[e]||(l[e]=[]);return n&&(s.reg=s.reg||a(e)),r(n,l,e),i!==this&&(r(n,this.$events,e),this.$events[e]=s),avalon.Array.ensure(s,t),function(){avalon.Array.remove(s,t)}}function i(e,t,n,a,r,o){if(e&&e.length)try{for(o=o||e.length-1;o>=0;o--){var l=e[o];l.call(t,a,r,n)}}catch(s){o-1>0&&i(e,t,n,a,r,o-1),avalon.log(s,n)}}o.adjust=n,e.exports={$emit:i,$watch:o,adjustVm:n}},function(e,t){var n=!0;try{Object.defineProperty({},"_",{value:"x"})}catch(a){n=!1}e.exports=n},function(e,t,n){function a(e,t,n,a){var r=t[n];return 4!==arguments.length?r.get.call(e):void r.set.call(e,a)}var r,o=n(80),i=n(68),l=Object.defineProperties,s=new Date-0;if(!o&&("__defineGetter__"in avalon&&(r=function(e,t,n){return"value"in n&&(e[t]=n.value),"get"in n&&e.__defineGetter__(t,n.get),"set"in n&&e.__defineSetter__(t,n.set),e},l=function(e,t){
for(var n in t)t.hasOwnProperty(n)&&r(e,n,t[n]);return e}),avalon.msie)){var c={};window.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function"].join("\n"),"VBScript"),l=function(e,t,n){var r=[];r.push("\r\n	Private [__data__], [__proxy__]","	Public Default Function [__const__](d"+s+", p"+s+")","		Set [__data__] = d"+s+": set [__proxy__] = p"+s,"		Set [__const__] = Me","	End Function");var o={__proxy__:!0,__data__:!0,__const__:!0};for(e in t)o[e]=!0,r.push("	Public Property Let ["+e+"](val"+s+")",'		Call [__proxy__](Me,[__data__], "'+e+'", val'+s+")","	End Property","	Public Property Set ["+e+"](val"+s+")",'		Call [__proxy__](Me,[__data__], "'+e+'", val'+s+")","	End Property","	Public Property Get ["+e+"]","	On Error Resume Next","		Set["+e+'] = [__proxy__](Me,[__data__],"'+e+'")',"	If Err.Number <> 0 Then","		["+e+'] = [__proxy__](Me,[__data__],"'+e+'")',"	End If","	On Error Goto 0","	End Property");for(e in n)o[e]!==!0&&(o[e]=!0,r.push("	Public ["+e+"]"));for(e in i)o[e]!==!0&&(o[e]=!0,r.push("	Public ["+e+"]"));r.push("	Public [hasOwnProperty]"),r.push("End Class");var l=r.join("\r\n"),u=c[l];u||(u=avalon.makeHashCode("VBClass"),window.parseVB("Class "+u+l),window.parseVB(["Function "+u+"Factory(a, b)","	Dim o","	Set o = (New "+u+")(a, b)","	Set "+u+"Factory = o","End Function"].join("\r\n")),c[l]=u);var v=window[u+"Factory"](t,a);return v}}e.exports=l}])});
//# sourceMappingURL=avalon.min.js.map